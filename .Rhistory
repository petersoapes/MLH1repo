coord_cartesian(ylim = c(0,150))
scatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 4)
fscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 4)
fscatter_biv <-  ggplot(female_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("Female Bivalent Measures") +
labs(x="Chrm Class", y= "SC Length") +
coord_cartesian(ylim = c(0,300))
fscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 4)
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("Female Bivalent Measures") +
labs(x="Chrm Class", y= "SC Length") +
coord_cartesian(ylim = c(0,300))
mscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 4)
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("male Bivalent Measures") +
labs(x="Chrm Class", y= "SC Length") +
coord_cartesian(ylim = c(0,300))
mscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 4)
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("male Bivalent Measures") +
labs(x="Chrm Class", y= "SC Length") +
coord_cartesian(ylim = c(0,300))
mscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6)
View(goodChrmMeasure_data)
View(goodChrmMeasure_list)
View(BivData)
View(female_biv_measures)
table(goodChrmMeasure_data$category)
goodChrmMeasure_data <- BivData[BivData$fileName %in% goodChrmMeasure_list$V1, ]
table(goodChrmMeasure_data$category)
table(BivData$category)
library(plyr)
library(lattice)
library(dplyr)
setwd("C:/Users/alpeterson7/Documents/MatLabChrmMeasures/")
BivData = read.csv("data/BBIIGG.csv")#return3 42,687 chrms
source("src/Func_addMouse.R")
BivData <- add_mouse(BivData)
source("src/Func_addCategory.R")
BivData <- add_category(BivData)
source("src/Func_addStrain.R")
BivData <- add_strain(BivData)
source("src/Func_addSex.R")
BivData <- add_sex(BivData)
DUP_list <- BivData$fileName[(grep('DUP', BivData$fileName))]
DUP_num = length(DUP_list)
BivData <- BivData[!(BivData$fileName %in% DUP_list), ]
dup_list= c()
for(i in BivData$fileName){  #change the file name header,
# print(i)
ifelse(grepl("\\.[0-9]_rev", i),
(dup_list = c(dup_list, i)), NA)
}
MultiCells = c()
for(j in dup_list){
stringLIST = strsplit(j, split="\\.")[[1]]
new_string = paste(stringLIST[[1]][1], "rev", sep="_")
MultiCells = c(MultiCells, new_string)
}
MultiCells = unique(MultiCells) #23270
multi_cell_num = length(MultiCells)
BivData <- BivData[!(BivData$fileName %in% MultiCells), ]#2329 images removed
bad_stain_mice = c("13jan17_LEW_f3","12jun15_WSB_m1","12sep16_MSM_f3","14jul17_SPRET_f2","13jan17_LEW_f2",
"30may17_SPRET_f1","30dec14_WSB_m4","31jul17_HMI_m1","30dec14_WSB_m5","16jun15_WSB_f4","30dec14_WSB_m1",
"30dec16_MSM_m1","14jul17_LEW_f1","1mar17_CAST_f1")
bad_stain_mice_len <- length(BivData[BivData$mouse %in% bad_stain_mice, ])
BivData <- BivData[!(is.na(BivData$mouse) ), ]
rawBivData = BivData
RawDataTable <- as.data.frame(colSums(!is.na(BivData)) )
write.table(RawDataTable, "results/RawDataTable.txt", sep="\t")
png(filename="results/rawData_plots.png", width =1200, height =500)#good dem for 1,3
par(mfrow=c(1,3))
cent_ABS_plot <- plot(rawBivData$centromere_ABS_Position, rawBivData$chromosomeLength,
main ="ABS cent position", xlab = "ABS cent pos", ylab = "SC Length" )
cent_PER_plot <- plot(rawBivData$centromere_PER_Position, rawBivData$chromosomeLength,
main ="PER cent position", xlab = "PER cent pos", ylab = "SC Length" )
rawFociCount_hist <-hist(rawBivData$FociCount, main= "Foci Count Hist")
dev.off()
num_7foci = length(BivData[(BivData$FociCount <7),])
BivData <- BivData[(BivData$FociCount <7), ]#2170 removed
rawBivData = BivData
setwd("C:/Users/alpeterson7/Documents/MatLabChrmMeasures/")
BivData = read.csv("data/BBIIGG.csv")#return3 42,687 chrms
source("src/Func_addMouse.R")
BivData <- add_mouse(BivData)
source("src/Func_addCategory.R")
BivData <- add_category(BivData)
source("src/Func_addStrain.R")
BivData <- add_strain(BivData)
source("src/Func_addSex.R")
BivData <- add_sex(BivData)
P_fileNames <- BivData$fileName[(grep('p_rev', BivData$fileName))]
prev_num = length(P_fileNames)
BivData <- BivData[!(BivData$fileName %in% P_fileNames), ]
DUP_list <- BivData$fileName[(grep('DUP', BivData$fileName))]
DUP_num = length(DUP_list)
BivData <- BivData[!(BivData$fileName %in% DUP_list), ]
dup_list= c()
for(i in BivData$fileName){  #change the file name header,
# print(i)
ifelse(grepl("\\.[0-9]_rev", i),
(dup_list = c(dup_list, i)), NA)
}
MultiCells = c()
for(j in dup_list){
stringLIST = strsplit(j, split="\\.")[[1]]
new_string = paste(stringLIST[[1]][1], "rev", sep="_")
MultiCells = c(MultiCells, new_string)
}
MultiCells = unique(MultiCells) #23270
multi_cell_num = length(MultiCells)
BivData <- BivData[!(BivData$fileName %in% MultiCells), ]#2329 images removed
bad_stain_mice = c("13jan17_LEW_f3","12jun15_WSB_m1","12sep16_MSM_f3","14jul17_SPRET_f2","13jan17_LEW_f2",
"30may17_SPRET_f1","30dec14_WSB_m4","31jul17_HMI_m1","30dec14_WSB_m5","16jun15_WSB_f4","30dec14_WSB_m1",
"30dec16_MSM_m1","14jul17_LEW_f1","1mar17_CAST_f1")
bad_stain_mice_len <- length(BivData[BivData$mouse %in% bad_stain_mice, ])
BivData <- BivData[!(is.na(BivData$mouse) ), ]
rawBivData = BivData
RawDataTable <- as.data.frame(colSums(!is.na(BivData)) )
write.table(RawDataTable, "results/RawDataTable.txt", sep="\t")
png(filename="results/rawData_plots.png", width =1200, height =500)#good dem for 1,3
par(mfrow=c(1,3))
cent_ABS_plot <- plot(rawBivData$centromere_ABS_Position, rawBivData$chromosomeLength,
main ="ABS cent position", xlab = "ABS cent pos", ylab = "SC Length" )
cent_PER_plot <- plot(rawBivData$centromere_PER_Position, rawBivData$chromosomeLength,
main ="PER cent position", xlab = "PER cent pos", ylab = "SC Length" )
rawFociCount_hist <-hist(rawBivData$FociCount, main= "Foci Count Hist")
dev.off()
num_7foci = length(BivData[(BivData$numberCrossOvers < 7),])
BivData <- BivData[(BivData$numberCrossOvers < 7), ]#2170 removed
colnames(BivData)
BivData <- BivData[ -c(26:127) ]#this should many extra columns
BivData <- BivData[(BivData$centromere_ABS_Position < 20), ]
BivData <- BivData[(BivData$centromere_PER_Position < .2), ] #removes ~1000 when both applied
png(filename="results/cleanData_plots.png", width =1200, height =500)#good dem for 1,3
par(mfrow=c(1,3))
cent_ABS_cplot <- plot(BivData$centromere_ABS_Position, BivData$chromosomeLength,
main ="ABS cent position", xlab = "ABS cent pos", ylab = "SC Length" )
cent_PER_cplot <- plot(BivData$centromere_PER_Position, BivData$chromosomeLength,
main ="PER cent position", xlab = "PER cent pos", ylab = "SC Length" )
FociCount_chist <-hist(BivData$FociCount, main= "Foci Count Hist",breaks = 5)
dev.off()
png(filename="results/cleanData_plots.png", width =1200, height =500)#good dem for 1,3
par(mfrow=c(1,3))
cent_ABS_cplot <- plot(BivData$centromere_ABS_Position, BivData$chromosomeLength,
main ="ABS cent position", xlab = "ABS cent pos", ylab = "SC Length" )
cent_PER_cplot <- plot(BivData$centromere_PER_Position, BivData$chromosomeLength,
main ="PER cent position", xlab = "PER cent pos", ylab = "SC Length" )
FociCount_chist <-hist(BivData$numberCrossOvers, main= "Foci Count Hist",breaks = 5)
dev.off()
png(filename="results/cleanData_hist.png", width =1200, height =500)#good dem for 1,3
par(mfrow=c(1,2))
raw_FC_hist <- hist(rawBivData$FociCount,
main ="raw Foci Count Distrb", xlab = "FociCount", ylab = "", sub="\n \n median blue, mean red")
abline(v=median(rawBivData$numberCrossOvers, na.rm = TRUE), col="blue")
abline(v=mean(rawBivData$numberCrossOvers, na.rm = TRUE), col="red")
dev.off()
rm(DUP_list)
save.image("data/BivData3.RData")
goodChrmMeasure_data <- BivData[BivData$fileName %in% goodChrmMeasure_list$V1, ]
goodChrmMeasure_list = read.csv("data/good_chrm_Measures.csv", header=FALSE)
count =1
goodChrmMeasure_list$V1 <- as.character(goodChrmMeasure_list$V1)
for(i in goodChrmMeasure_list$V1){
#print(i)
templist= strsplit(i, split="_")[[1]]
c = paste(templist[1], templist[2],templist[3],templist[4],templist[5],templist[6],templist[7], sep = "_")
goodChrmMeasure_list$V1[count] <- c
count= count +1
}
goodChrmMeasure_data <- BivData[BivData$fileName %in% goodChrmMeasure_list$V1, ]
View(goodChrmMeasure_data)
table(BivData$category)
table(goodChrmMeasure_data$category)
table(goodChrmMeasure_data$numberCrossOvers)
hist(goodChrmMeasure_data$chromosomeLength)
plot(goodChrmMeasure_data$chromosomeLength, goodChrmMeasure_data$numberCrossOvers)
female_biv_measures <- goodChrmMeasure_data[goodChrmMeasure_data$sex == "female",]
male_biv_measures <- goodChrmMeasure_data[goodChrmMeasure_data$sex == "male",]
fscatter_biv <-  ggplot(female_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("Female Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,300))
fscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 4)
fscatter_biv <-  ggplot(female_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("Female Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,300))
fscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6)
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,300))
mscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6)
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,300))
mscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6, nrow=2)
colnames(goodChrmMeasure_data)
ABS_foci_cols = c(8, 11, 14, 17, 20, 23)
BivData <- subset(goodChrmMeasure_data, FociCount <= 4) #
BivData <- subset(goodChrmMeasure_data, numberCrossOvers <= 4) #
coco_names <- colnames(BivData)
coco_names
dm1 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex",ABS_foci_cols)],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex"))
ABS_foci_cols
dm1 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex",c(8, 11, 14, 17, 20, 23))],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex"))
coco_names
ABS_foci_cols = c(coco_names[c(8, 11, 14, 17, 20, 23)]
#subset data to constance columns + foci_abs_pos
dm1 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers","boxNumber",
"mouse","category","strain", "sex", ],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex"))
#clean up dm1 (there are a bunch of rows without useful information)
dm1 <- dm1[(!is.na(dm1$value)),]
colnames(dm1) <- c(coco_names[c(1:6,26:29)], "Foci_Type", "Position_Pixels") #too many foci
#Foci_PER Positions
#isolate the right indeces
PER_index_list = c()
for( each in 1:length(colnames(BivData))  ){
new_PER_index = (each*3)+6
if( (new_PER_index > 5) && (new_PER_index < 25) ){
print(each)
PER_index_list = c(PER_index_list, new_PER_index)
}
}
PER_index_list
#reference the right column names with those indeces
PER_foci_cols = c()
for(u in 1: length(PER_index_list) ){
PER_foci_cols[u] = coco_names[PER_index_list[u]]
#  print(coco_names[PER_index_list[u]])
}
PER_foci_cols
dm2 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex",PER_foci_cols)],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex"))
#clean dm2
dm2 <- dm2[(!is.na(dm2$value)),]
colnames(dm2) <- c(coco_names[c(1:6,26:29)], "Foci_Type2", "Position_Percent")
#Foci_intensity -- can't get correct seq for intensities, leave out for now
INT_index_list = c()
for( each in 1:length(colnames(BivData))  ){
new_INT_index = (each*3)+5
if( (new_INT_index > 5) && (new_INT_index < 26) ){
print(each)
INT_index_list = c(INT_index_list, new_INT_index)
}
}
INT_index_list
#reference the right column names with those indeces
INT_foci_cols = c()
for(u in 1: length(INT_index_list) ){
INT_foci_cols[u] = coco_names[INT_index_list[u]]
print(coco_names[INT_index_list[u]])
}
INT_foci_cols
dm3 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex", INT_foci_cols)],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex"
))
dm3 <- dm3[(!is.na(dm3$value)),]
colnames(dm3) <- c(coco_names[c(1:6,26:29)], "Foci_Type3", "Foci_INT")
#dm3 ends up being quite buggy
#DM is df with position data witin one column. This makes plotting much more straightforward.
dm <- cbind(dm1, dm2[,11:12], dm3[,11:12])
#dmco2 <- dm[dm$FociCount==2,]
hist(dm$Position_Percent, breaks = 10)
ABS_foci_cols = coco_names[c(8, 11, 14, 17, 20, 23)]
ABS_foci_cols
dm1 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers","boxNumber",
"mouse","category","strain", "sex", ABS_foci_cols)],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers",
"mouse","category","strain", "sex"))
View(dm1)
dm1 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers","boxNumber",
"mouse","category","strain", "sex", ABS_foci_cols)],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers","boxNumber",
"mouse","category","strain", "sex"))
View(dm1)
dm1 <- dm1[(!is.na(dm1$value)),]
coco_names
colnames(dm1) <- c(coco_names[c(1:6,26:29)], "Foci_Type", "Position_Pixels") #too many foci
colnames(dm1) <- c(coco_names[c(1:7,26:29)], "Foci_Type", "Position_Pixels") #too many foci
PER_foci_cols = coco_names[c(9,12,15,18,21,24)]
dm2 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers","boxNumber",
"mouse","category","strain", "sex",PER_foci_cols)],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers","boxNumber",
"mouse","category","strain", "sex"))
View(dm2)
dm2 <- dm2[(!is.na(dm2$value)),]
colnames(dm2) <- c(coco_names[c(1:7,26:29)], "Foci_Type2", "Position_Percent")
INT_foci_cols = coco_names[c(10,13,16,19,22,25)]
dm3 <- melt(BivData[,c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers","boxNumber",
"mouse","category","strain", "sex", INT_foci_cols)],
id=c("fileName", "chromosomeLength","centromere_ABS_Position",
"centromere_PER_Position","avergeRED","numberCrossOvers","boxNumber",
"mouse","category","strain", "sex"
))
View(dm3)
dm3 <- dm3[(!is.na(dm3$value)),]
colnames(dm3) <- c(coco_names[c(1:7,26:29)], "Foci_Type3", "Foci_INT")
colnames(dm2)
dm <- cbind(dm1, dm2[,12:13], dm3[,12:13])
hist(dm$Position_Percent, breaks = 10)
qq <- ggplot(dm, aes(x = Position_Percent)) + geom_histogram() +
ggtitle("Relative Foci Position by Foci number")
qq <- qq + facet_wrap(~ numberCrossOvers, ncol = 1) #this is breaking the kniting...
qq
dm_f <- dm[(dm$sex == "female"),]
dm_m <- dm[(dm$sex == "male"),]
popo_f <- ggplot(dm_f, aes(x = Position_Percent)) + geom_histogram() +
ggtitle("Relative Foci Position by Foci number", subtitle = unique(dm_f$sex) )
popo_f <- popo_f + facet_wrap(~ numberCrossOvers, ncol = 1) #this is breaking the kniting...
popo_f
popo_m <- ggplot(dm_m, aes(x = Position_Percent)) + geom_histogram() +
ggtitle("Relative Foci Position by Foci number", subtitle = unique(dm_m$sex) )
popo_m <- popo_m + facet_wrap(~ numberCrossOvers, ncol = 1) #this is breaking the kniting...
popo_m
table(dm$category)
fs_strains <- split(dm_f, dm_f$strain)
plot_list = list()
for (h in 1:length(split_dmf)) {
pf <- ggplot(split_dmf[[h]],(aes(x = Position_Percent))) +
geom_histogram() +  ggtitle("relative Foci Position by Foci number", subtitle = unique(split_dmf[[h]]$category))
#add manual fill colors
pf <- pf + facet_wrap(~ numberCrossOvers, ncol = 1 )
plot_list[[h]] =   pf
}
plot_list = list()
for (h in 1:length(fs_strains)) {
pf <- ggplot(fs_strains[[h]],(aes(x = Position_Percent))) +
geom_histogram() +  ggtitle("relative Foci Position by Foci number", subtitle = unique(split_dmf[[h]]$category))
#add manual fill colors
pf <- pf + facet_wrap(~ numberCrossOvers, ncol = 1 )
plot_list[[h]] =   pf
}
for (h in 1:length(fs_strains)) {
pf <- ggplot(fs_strains[[h]],(aes(x = Position_Percent))) +
geom_histogram() +  ggtitle("relative Foci Position by Foci number", subtitle = unique(fs_strains[[h]]$category))
#add manual fill colors
pf <- pf + facet_wrap(~ numberCrossOvers, ncol = 1 )
plot_list[[h]] =   pf
}
for (gg in 1:length(plot_list) ){
show(plot_list[gg])
}
show(plot_list[6])
show(plot_list[1])
show(plot_list[2])
show(plot_list[3])
show(plot_list[4])
show(plot_list[5])
show(plot_list[6])
show(plot_list[7])
show(plot_list[8])
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200))
mscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6, nrow=2)
View(male_biv_measures)
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength, fill=foci_PER_Position_1) ) +
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200)) +scale_color_gradient(low = "blue", high = "yellow")
mscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6, nrow=2)
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength, fill=foci_PER_Position_1) ) +
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200)) + scale_color_gradient(low = "blue", high = "yellow")
mscatter_biv + geom_jitter(width = 0.20) + scale_color_gradient(low = "blue", high = "yellow")+
facet_wrap( ~ strain, scales = "free_x", ncol = 6, nrow=2)
mscatter_biv <-  ggplot(male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200)) + scale_color_gradient(low = "blue", high = "yellow")
mscatter_biv +geom_point(aes(fill=foci_PER_Position_1))+ geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6, nrow=2)
mini_male_biv_measures <- subset(goodChrmMeasure_data, numberCrossOvers == 1)
mscatter_biv <-  ggplot(mini_male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200)) + scale_color_gradient(low = "blue", high = "yellow")
mscatter_biv +geom_point(aes(fill=foci_PER_Position_1))+ geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6, nrow=2)
mini_male_biv_measures <- subset(goodChrmMeasure_data, numberCrossOvers = 1)
mscatter_biv <-  ggplot(mini_male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength) ) +
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200)) + scale_color_gradient(low = "blue", high = "yellow")
mscatter_biv +geom_point(aes(fill=foci_PER_Position_1))+ geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6, nrow=2)
mscatter_biv <-  ggplot(mini_male_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength, color=foci_PER_Position_1) ) + geom_point()+
ggtitle("male Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200)) + scale_color_gradient(low = "blue", high = "yellow")
mscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6, nrow=2)
fscatter_biv <-  ggplot(female_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength, color=foci_PER_Position_1) ) + geom_point()+
ggtitle("Female Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200))++ scale_color_gradient(low = "blue", high = "yellow")
fscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6)
fscatter_biv <-  ggplot(female_biv_measures,
aes(x=numberCrossOvers, y=chromosomeLength, color=foci_PER_Position_1) ) + geom_point()+
ggtitle("Female Bivalent Measures") +
labs(x="CO num", y= "SC Length") +
coord_cartesian(ylim = c(0,200))+ scale_color_gradient(low = "blue", high = "yellow")
fscatter_biv + geom_jitter(width = 0.20) +
facet_wrap( ~ strain, scales = "free_x", ncol = 6)
set.seed(42)
n<-sample.rows(data.frame(a=c(1,2,3), b=c(4,5,6), row.names=c('a', 'b', 'c')), 10, replace=TRUE)
library(kimisc)
dm <- matrix(1:25, ncol = 5); dm
dm <- dm[ sample(nrow(dm)), sample( ncol(dm)) ]
dm
dm <- dm[ sample(nrow(dm)), sample( ncol(dm)) ]
dm
dm <- dm[ sample(nrow(dm)),1 ]
dm
dm[,1] <- dm[ sample(nrow(dm)),1]
dm[,1] <- dm[ sample(nrow(dm))]
dm[1] <- dm[ sample(nrow(dm))]
dm[,1] <- dm[, sample(nrow(dm))]
dm9 <- dm[, sample(nrow(dm))]
df1 <- data.frame(A=c("xx", "be", "zz", "jj"), B=c("xyx", "bea", "cce", "ggg"), C=c("ges", "xyz", "cce", "edga"))
df2 <- transform( df1, C = sample(C) )
df1
df2
df2 <- transform( df1, C = sample(C) )
df2
library(plyr)
library(dplyr)
library(ggplot2)
setwd("C:/Users/alpeterson7/Documents/MLH1repo")
load(file="MLH1_data_setup.RData")
MLH1_data<- MLH1_data[!grepl("4apr15_WSB_f2", MLH1_data$mouse) , ] #1649
MLH1_data<- MLH1_data[!grepl("12sep16_MSM_f1", MLH1_data$mouse) , ]
MLH1_data<- MLH1_data[!grepl("4jan17_LEW_f1", MLH1_data$mouse) , ]#one duplicate image found
Mouse_table <- ddply(MLH1_data, c("strain", "sex", "mouse"), summarise,
Nmice = length(unique(mouse)),
Ncells  = length(adj_nMLH1.foci),
mean_co = as.numeric(format(round(  mean(adj_nMLH1.foci), 3 ), nsmall=3) ),
var = format(round(   var(adj_nMLH1.foci),3), nsmall=3),
sd   = round(sd(adj_nMLH1.foci), 3),
se   = round(sd / sqrt(Ncells), 3),
cV = round( (as.numeric(sd) / as.numeric(mean_co) ),3)
)
source("src/Func_addSubsp.R")
Mouse_table <- add_subsp(Mouse_table)
Dom_Mouse_table <- subset(Mouse_table, strain == "WSB" | strain == "G" | strain == "LEWES")
Musc_Mouse_table <- subset(Mouse_table, strain == "PWD" | strain == "MSM")
Cast_Mouse_table <- subset(Mouse_table, strain == "CAST" | strain == "HMI")
Dom_per <- transform(Dom_Mouse_table, sex = sample(sex))
Dom_per
