twenty_data_table <- ddply(twenty_data, c("mouse"), summarise,
Nmice = length(unique(mouse)),
Ncells  = length(adj_nMLH1.foci),
mean_co = format(round(  mean(adj_nMLH1.foci), 3 ), nsmall=3),
cV = cv(adj_nMLH1.foci),
var = format(round(   var(adj_nMLH1.foci),3), nsmall=3),
sd   = round(sd(adj_nMLH1.foci), 3),
se   = round(sd / sqrt(Ncells), 3)
)
twenty_data_table
outlist15 = list()
for(fif in 1:length(unique(twenty$mouse))){
print(twenty$mouse[fif])
#
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[fif],]
outlist15[fif] <- list(replicate(100, t.test(sample(mus_data$adj_nMLH1.foci, 15, replace = TRUE),
sample(mus_data$adj_nMLH1.foci, 15, replace = TRUE) )$p.value ) )
}
for(fif in 1:length(unique(twenty$mouse))){
print(twenty$mouse[fif])
#
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[fif],]
outlist15[fif] <- list(replicate(100, t.test(sample(mus_data$adj_nMLH1.foci, 15, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 15, replace = FALSE) )$p.value ) )
}
names(outlist15) <- twenty$mouse
outlist10 = list()
for(ten in 1:length(unique(twenty$mouse))){
print(twenty$mouse[ten])
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[ten],]
outlist10[ten] <- list(replicate(100, t.test(sample(mus_data$adj_nMLH1.foci, 10, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 10, replace = FALSE) )$p.value ) )
}
names(outlist10) <- twenty$mouse
outlist20 = list()
outlist20 = list()
for(tw in 1:length(unique(twenty$mouse))){
print(twenty$mouse[tw])
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[tw],]
outlist20[tw] <- list(replicate(100, t.test(sample(mus_data$adj_nMLH1.foci, 20, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 20, replace = FALSE) )$p.value ) )
}
names(outlist20) <- twenty$mouse
plot_list20 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist20[[i]])
colnames(try_df) <- "pvals"
Title_mus_name <- paste("Sample of 20, \n", names(outlist20[i]) )
p20 <- ggplot(try_df) + ggtitle( Title_mus_name ) +
geom_histogram(aes(x=pvals) )#xlim
plot_list20[[i]] <- p20
}
plot_list10 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist10[[i]])
Title_mus_name <- paste("Sample of 10, \n", names(outlist10[i]) )
colnames(try_df) <- "pvals"
p10 <- ggplot(try_df) +
geom_histogram(aes(x=pvals) )#xlim
#tryfiting 3 plots
plot_list10[[i]] <- p10
}
plot_list15 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist15[[i]])
Title_mus_name <- paste("Sample of 15, \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
p15 <- ggplot(try_df) +
geom_histogram(aes(x=pvals) )#xlim
#tryfiting 3 plots
plot_list15[[i]] <- p15
}
for(i in 1:5) {
file_name = paste("Sample_sizes_p_", i, ".tiff", sep="")
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(plot_list10[[i]], plot_list15[[i]], plot_list20[[i]])
#print(c(plot_list[[i]], plot_list20[[i]]) )
#print(plot_list20[[i]] )
dev.off()
}
plot_list10 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist10[[i]])
Title_mus_name <- paste("Sample of 10, \n", names(outlist10[i]) )
colnames(try_df) <- "pvals"
p10 <- ggplot(try_df) + ggtitle( Title_mus_name ) +
geom_histogram(aes(x=pvals) )#xlim
#tryfiting 3 plots
plot_list10[[i]] <- p10
}
plot_list15 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist15[[i]])
Title_mus_name <- paste("Sample of 15, \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
p15 <- ggplot(try_df) + ggtitle( Title_mus_name ) +
geom_histogram(aes(x=pvals) )#xlim
#tryfiting 3 plots
plot_list15[[i]] <- p15
}
for(i in 1:5) {
file_name = paste("Sample_sizes_p_", i, ".tiff", sep="")
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(plot_list10[[i]], plot_list15[[i]], plot_list20[[i]])
#print(c(plot_list[[i]], plot_list20[[i]]) )
#print(plot_list20[[i]] )
dev.off()
}
=
sim_iterations <- 1000
outlist15 = list()
for(fif in 1:length(unique(twenty$mouse))){
print(twenty$mouse[fif])
#
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[fif],]
outlist15[fif] <- list(replicate(sim_iterations, t.test(sample(mus_data$adj_nMLH1.foci, 15, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 15, replace = FALSE) )$p.value ) )
}
names(outlist15) <- twenty$mouse
outlist10 = list()
for(ten in 1:length(unique(twenty$mouse))){
print(twenty$mouse[ten])
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[ten],]
outlist10[ten] <- list(replicate(sim_iterations, t.test(sample(mus_data$adj_nMLH1.foci, 10, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 10, replace = FALSE) )$p.value ) )
}
names(outlist10) <- twenty$mouse
outlist20 = list()
for(tw in 1:length(unique(twenty$mouse))){
print(twenty$mouse[tw])
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[tw],]
outlist20[tw] <- list(replicate(sim_iterations, t.test(sample(mus_data$adj_nMLH1.foci, 20, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 20, replace = FALSE) )$p.value ) )
}
names(outlist20) <- twenty$mouse
plot_list20 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist20[[i]])
colnames(try_df) <- "pvals"
Title_mus_name <- paste("1000 iterations\n, Sample of 20, \n", names(outlist20[i]) )
p20 <- ggplot(try_df) + ggtitle( Title_mus_name ) + xlim(0,1)+
geom_histogram(aes(x=pvals) )#xlim
plot_list20[[i]] <- p20
}
plot_list10 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist10[[i]])
Title_mus_name <- paste("1000 iterations\n Sample of 10, \n", names(outlist10[i]) )
colnames(try_df) <- "pvals"
p10 <- ggplot(try_df) + ggtitle( Title_mus_name ) +xlim(0,1)+
geom_histogram(aes(x=pvals) )#xlim
#tryfiting 3 plots
plot_list10[[i]] <- p10
}
plot_list15 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist15[[i]])
Title_mus_name <- paste("1000 iterations\n Sample of 15, \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
p15 <- ggplot(try_df) + ggtitle( Title_mus_name ) + xlim(0,1)+
geom_histogram(aes(x=pvals) )#xlim
#tryfiting 3 plots
plot_list15[[i]] <- p15
}
for(i in 1:5) {
file_name = paste("Sample_sizes_p_", i, ".tiff", sep="")
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(plot_list10[[i]], plot_list15[[i]], plot_list20[[i]])
#print(c(plot_list[[i]], plot_list20[[i]]) )
#print(plot_list20[[i]] )
dev.off()
}
p15 <- ggplot(try_df) + ggtitle( Title_mus_name ) + xlim(0,1)+
geom_jitter(aes(y=pvals) )
p15
sc15 <- ggplot(try_df) + ggtitle( Title_mus_name ) +
geom_jitter(aes(y=pvals) )
sc15
sc15 <- ggplot(try_df) + ggtitle( Title_mus_name ) +
geom_jitter(aes(x=1, y=pvals) )
sc15
head(outlist20)
head(outlist20[1:5])
df10 <- as.data.frame(outlist10[[i]])
df15 <- as.data.frame(outlist15[[i]])
df20 <-as.data.frame(outlist20[[i]])
df10
allDF <- data.frame(samp10 = df10, samp15=df15, samp20 =df20 )
allDF
head(allDF)
names(allDF)
names(allDF) <- c("samp10", "samp15", "samp20")
names(allDF)
names(allDF)
head(allDF)
library(reshape2)
cheezy <- melt(allDF)
airquality
melt(airquality, id=c("month", "day"))
names(airquality) <- tolower(names(airquality))
melt(airquality, id=c("month", "day"))
doinIT <- melt(allDF, id=c("samp10", "samp15", "samp20"))
doinIT
head(doinIT)
plot(allDF$samp10)
rep(fred, 5).
rep(fred, 5)
rep("fred", 5)
length(df10)
length(df10[,1])
allDF <- data.frame(pvals = c(df10, df15, df20),
DFsets = c (rep("samp10",length(df10[,1]) ),
rep("samp15",length(df10[,1])),
rep("samp20", length(df10[,1])) )
)
head(allDF)
allDF <- data.frame(pvals = list(df10, df15, df20),
DFsets = c (rep("samp10",length(df10[,1]) ),
rep("samp15",length(df10[,1])),
rep("samp20", length(df10[,1])) )
)
head(allDF)
allDF <- data.frame(pvals = rbind(df10, df15, df20),
DFsets = c (rep("samp10",length(df10[,1]) ),
rep("samp15",length(df10[,1])),
rep("samp20", length(df10[,1])) )
)
jj <- rbind(df10, df15, df20)
names(c(df10,df15, df20) ) <- "pvals"
names(c(df10,df15, df20) )
names(c(df10,df15, df20) ) <- c("pvals","pvals","pvals")
names(c(df10,df15, df20) ) = c("pvals","pvals","pvals")
names(df10) = "pvals"
names(df15)= "pvals"
names(df20)= "pvals"
jj <- rbind(df10, df15, df20)
head(jj)
tail(jj)
allDF <- data.frame(pvals = rbind(df10, df15, df20),
DFsets = c (rep("samp10",length(df10[,1]) ),
rep("samp15",length(df10[,1])),
rep("samp20", length(df10[,1])) )
)
head(allDF)
tail(allDF)
sc15 <- ggplot(allDF) + ggtitle( "p-values scatter" ) +
geom_jitter(aes(x=DFsets, y=pvals) )
sc15
Title_mus_name <- paste("1000 iterations\n Test of 2 Samples of 15, \n", names(outlist15[i]) )
sc15 <- ggplot(allDF) + ggtitle( Title_mus_name) +
geom_jitter(aes(x=DFsets, y=pvals) )#xlim
sc15
sctr_plot = list()
for (i in 1:length(twenty$mouse)){
print(i)
df10 <- as.data.frame(outlist10[[i]])
df15 <- as.data.frame(outlist15[[i]])
df20 <-as.data.frame(outlist20[[i]])
names(df10) = "pvals"
names(df15)= "pvals"
names(df20)= "pvals"
allDF <- data.frame(pvals = rbind(df10, df15, df20),
DFsets = c (rep("samp10",length(df10[,1]) ),
rep("samp15",length(df10[,1])),
rep("samp20", length(df10[,1])) )
)
Title_mus_name <- paste("1000 iterations\n Pvalues of T-tests \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
scplot <- ggplot(allDF) + ggtitle( Title_mus_name) +
geom_jitter(aes(x=DFsets, y=pvals) )#xlim
#tryfiting 3 plots
sctr_plot[[i]] <- scplot
}
for(i in 1:5) {
file_name = paste("Scatter_plots_", i, ".tiff", sep="")
tiff(file_name)
#par( mfrow=c(1,2) )
print(sctr_plot[[i]] )
#multiplot(plot_list10[[i]], plot_list15[[i]], plot_list20[[i]])
#print(c(plot_list[[i]], plot_list20[[i]]) )
dev.off()
}
for(i in 1:5) {
file_name = paste("Sample_sizes_p_", i, ".tiff", sep="")
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(plot_list10[[i]], plot_list15[[i]], plot_list20[[i]], sctr_plot[[i]], col=2)
#print(c(plot_list[[i]], plot_list20[[i]]) )
#print(plot_list20[[i]] )
dev.off()
}
for(i in 1:5) {
file_name = paste("Sample_sizes_p_", i, ".tiff", sep="")
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(plot_list10[[i]], plot_list15[[i]], plot_list20[[i]], sctr_plot[[i]], cols=2)
#print(c(plot_list[[i]], plot_list20[[i]]) )
#print(plot_list20[[i]] )
dev.off()
}
for(i in 1:10) {
file_name = paste("Sample_sizes_p_", i, ".tiff", sep="")
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(sctr_plot[[i]], plot_list10[[i]], plot_list15[[i]], plot_list20[[i]],cols=2)
dev.off()
}
setwd("C:/Users/alpeterson7/Documents/MLH1repo")
for(i in 1:10) {
file_name = paste("Sample_sizes_p_", i, ".tiff", sep="")
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(sctr_plot[[i]], plot_list10[[i]], plot_list15[[i]], plot_list20[[i]],cols=2)
dev.off()
}
sim_iterations <- 10000
outlist15 = list()
for(fif in 1:length(unique(twenty$mouse))){
print(twenty$mouse[fif])
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[fif],]
outlist15[fif] <- list(replicate(sim_iterations, t.test(sample(mus_data$adj_nMLH1.foci, 15, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 15, replace = FALSE) )$p.value ) )
}
outlist10 = list()
for(ten in 1:length(unique(twenty$mouse))){
print(twenty$mouse[ten])
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[ten],]
outlist10[ten] <- list(replicate(sim_iterations, t.test(sample(mus_data$adj_nMLH1.foci, 10, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 10, replace = FALSE) )$p.value ) )
}
ten
tw
outlist20 = list()
for(tw in 1:length(unique(twenty$mouse))){
print(twenty$mouse[tw])
mus_data <- twenty_data[twenty_data$mouse == twenty$mouse[tw],]
outlist20[tw] <- list(replicate(sim_iterations, t.test(sample(mus_data$adj_nMLH1.foci, 20, replace = FALSE),
sample(mus_data$adj_nMLH1.foci, 20, replace = FALSE) )$p.value ) )
}
plot_list10 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist10[[i]])
Title_mus_name <- paste("1000 iterations\n Test of 2 Samples of 10, \n", names(outlist10[i]) )
colnames(try_df) <- "pvals"
p10 <- ggplot(try_df) + ggtitle( Title_mus_name ) +xlim(0,1)+
geom_histogram(aes(x=pvals) )
plot_list10[[i]] <- p10
}
plot_list15 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist15[[i]])
Title_mus_name <- paste("1000 iterations\n Test of 2 Samples of 15, \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
p15 <- ggplot(try_df) + ggtitle( Title_mus_name ) + xlim(0,1)+
geom_histogram(aes(x=pvals) )#xlim
#tryfiting 3 plots
plot_list15[[i]] <- p15
}
plot_list20 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist20[[i]])
colnames(try_df) <- "pvals"
Title_mus_name <- paste("1000 iterations\n, Test of 2 Samples of 20, \n", names(outlist20[i]) )
p20 <- ggplot(try_df) + ggtitle( Title_mus_name ) + xlim(0,1)+
geom_histogram(aes(x=pvals) )
plot_list20[[i]] <- p20
}
sctr_plot = list()
for (i in 1:length(twenty$mouse)){
print(i)
df10 <- as.data.frame(outlist10[[i]])
df15 <- as.data.frame(outlist15[[i]])
df20 <-as.data.frame(outlist20[[i]])
names(df10) = "pvals"
names(df15)= "pvals"
names(df20)= "pvals"
allDF <- data.frame(pvals = rbind(df10, df15, df20),
DFsets = c (rep("samp10",length(df10[,1]) ),
rep("samp15",length(df10[,1])),
rep("samp20", length(df10[,1])) )
)
Title_mus_name <- paste("1000 iterations\n Pvalues of T-tests \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
scplot <- ggplot(allDF) + ggtitle( Title_mus_name) +
geom_jitter(aes(x=DFsets, y=pvals) )
sctr_plot[[i]] <- scplot
}
plot_list10 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist10[[i]])
Title_mus_name <- paste("10000 iterations\n Test of 2 Samples of 10, \n", names(outlist10[i]) )
colnames(try_df) <- "pvals"
p10 <- ggplot(try_df) + ggtitle( Title_mus_name ) +xlim(0,1)+
geom_histogram(aes(x=pvals) )
plot_list10[[i]] <- p10
}
plot_list15 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist15[[i]])
Title_mus_name <- paste("10000 iterations\n Test of 2 Samples of 15, \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
p15 <- ggplot(try_df) + ggtitle( Title_mus_name ) + xlim(0,1)+
geom_histogram(aes(x=pvals) )#xlim
#tryfiting 3 plots
plot_list15[[i]] <- p15
}
plot_list20 = list()
for (i in 1:length(twenty$mouse)){
print(i)
try_df <- as.data.frame(outlist20[[i]])
colnames(try_df) <- "pvals"
Title_mus_name <- paste("10000 iterations\n, Test of 2 Samples of 20, \n", names(outlist20[i]) )
p20 <- ggplot(try_df) + ggtitle( Title_mus_name ) + xlim(0,1)+
geom_histogram(aes(x=pvals) )
plot_list20[[i]] <- p20
}
sctr_plot = list()
for (i in 1:length(twenty$mouse)){
print(i)
df10 <- as.data.frame(outlist10[[i]])
df15 <- as.data.frame(outlist15[[i]])
df20 <-as.data.frame(outlist20[[i]])
names(df10) = "pvals"
names(df15)= "pvals"
names(df20)= "pvals"
allDF <- data.frame(pvals = rbind(df10, df15, df20),
DFsets = c (rep("samp10",length(df10[,1]) ),
rep("samp15",length(df10[,1])),
rep("samp20", length(df10[,1])) )
)
Title_mus_name <- paste("1000 iterations\n Pvalues of T-tests \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
scplot <- ggplot(allDF) + ggtitle( Title_mus_name) +
geom_jitter(aes(x=DFsets, y=pvals) )
sctr_plot[[i]] <- scplot
}
sctr_plot = list()
for (i in 1:length(twenty$mouse)){
print(i)
df10 <- as.data.frame(outlist10[[i]])
df15 <- as.data.frame(outlist15[[i]])
df20 <-as.data.frame(outlist20[[i]])
names(df10) = "pvals"
names(df15)= "pvals"
names(df20)= "pvals"
allDF <- data.frame(pvals = rbind(df10, df15, df20),
DFsets = c (rep("samp10",length(df10[,1]) ),
rep("samp15",length(df10[,1])),
rep("samp20", length(df10[,1])) )
)
Title_mus_name <- paste("10000 iterations\n Pvalues of T-tests \n", names(outlist15[i]) )
colnames(try_df) <- "pvals"
scplot <- ggplot(allDF) + ggtitle( Title_mus_name) +
geom_jitter(aes(x=DFsets, y=pvals) )
sctr_plot[[i]] <- scplot
}
source("src/MultiPlot.R")
for(i in 1:15) {
file_name = paste("Sample_sizes_p_", names(outlist15[i]), ".tiff", sep="")#names(outlist15[i]
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(sctr_plot[[i]], plot_list10[[i]], plot_list15[[i]], plot_list20[[i]],cols=2)
dev.off()
}
setwd("C:/Users/alpeterson7/Documents/MLH1repo")
for(i in 1:15) {
file_name = paste("Sample_sizes_p_", names(outlist15[i]), ".tiff", sep="")#names(outlist15[i]
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(sctr_plot[[i]], plot_list10[[i]], plot_list15[[i]], plot_list20[[i]],cols=2)
dev.off()
}
names(outlist15[i])
plot_list10[[i]]
twenty$mouse[i]
for(i in 1:15) {
file_name = paste("Sample_sizes_p_", twenty$mouse[i], "_", ".tiff", sep="")#names(outlist15[i]
tiff(file_name)
#par( mfrow=c(1,2) )
multiplot(sctr_plot[[i]], plot_list10[[i]], plot_list15[[i]], plot_list20[[i]],cols=2)
dev.off()
}
names(outlist15[i]
)
head(df20)
median20 -> median(df20)
median20 <- median(df20)
median20 <- median(as.numeric(df20) )
median20 <- mean(as.numeric(df20) )
median20 <- mean(as.numeric(as.charecter(df20) ) )
median20 <- mean(as.numeric(as.character(df20) ) )
median20
median20 <- mean(df20)
median20
mean(try_df$pvals)
median(try_df$pvals)
