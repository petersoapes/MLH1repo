category_pwr_stat <- ddply(MLH1_data, "category", function(x) {
Nmice <- length( unique(x$mouse) )
mean.count <- mean(x$adj_nMLH1.foci)
sd.count <- sd(x$adj_nMLH1.foci)
cv <- sd.count/mean.count
ttest <- t.test(x$adj_nMLH1.foci, (20), alternative = "one", var.equal=TRUE)$p.value
ttestCI.lowr <- t.test(x$adj_nMLH1.foci, (20), alternative = "one", var.equal=TRUE)$conf.int[1]
ttestCI.upr <- t.test(x$adj_nMLH1.foci, (20), alternative = "one", var.equal=TRUE)$conf.int[2]
ttest.est <- t.test(x$adj_nMLH1.foci, (20), alternative = "one", var.equal=TRUE)$estimate
pwr5mice <- pwr.norm.test(d = (3/sd.count), n = 20, sig.level = 0.05, alternative = "one")$power
data.frame(Nmice=Nmice, cv.count = cv, ttest=ttest, CIlower = ttestCI.lowr,
CIupr = ttestCI.upr,
pwr = pwr5mice, ttest.est=ttest.est)
})
#for the record, this is a way to make a table with pwr and t.test results
category_pwr_stat <- ddply(MLH1_data, "category", function(x) {
Nmice <- length( unique(x$mouse) )
mean.count <- mean(x$adj_nMLH1.foci)
sd.count <- sd(x$adj_nMLH1.foci)
cv <- sd.count/mean.count
ttest <- t.test(x$adj_nMLH1.foci, (20), alternative = "greater", var.equal=TRUE)$p.value
ttestCI.lowr <- t.test(x$adj_nMLH1.foci, (20), alternative = "greater", var.equal=TRUE)$conf.int[1]
ttestCI.upr <- t.test(x$adj_nMLH1.foci, (20), alternative = "greater", var.equal=TRUE)$conf.int[2]
ttest.est <- t.test(x$adj_nMLH1.foci, (20), alternative = "greater", var.equal=TRUE)$estimate
pwr5mice <- pwr.norm.test(d = (3/sd.count), n = 20, sig.level = 0.05, alternative = "greater")$power
data.frame(Nmice=Nmice, cv.count = cv, ttest=ttest, CIlower = ttestCI.lowr,
CIupr = ttestCI.upr,
pwr = pwr5mice, ttest.est=ttest.est)
})
category_pwr_stat
plot(category_pwr_stat$category, category_pwr_stat$ttest.est)
#for the record, this is a way to make a table with pwr and t.test results
category_pwr_stat <- ddply(MLH1_data, "category", function(x) {
Nmice <- length( unique(x$mouse) )
mean.count <- mean(x$adj_nMLH1.foci)
sd.count <- sd(x$adj_nMLH1.foci)
cv <- sd.count/mean.count
ttest <- t.test(x$adj_nMLH1.foci, (20), alternative = "less", var.equal=TRUE)$p.value
ttestCI.lowr <- t.test(x$adj_nMLH1.foci, (20), alternative = "less", var.equal=TRUE)$conf.int[1]
ttestCI.upr <- t.test(x$adj_nMLH1.foci, (20), alternative = "less", var.equal=TRUE)$conf.int[2]
ttest.est <- t.test(x$adj_nMLH1.foci, (20), alternative = "less", var.equal=TRUE)$estimate
pwr5mice <- pwr.norm.test(d = (3/sd.count), n = 20, sig.level = 0.05, alternative = "less")$power
data.frame(Nmice=Nmice, cv.count = cv, ttest=ttest, CIlower = ttestCI.lowr,
CIupr = ttestCI.upr,
pwr = pwr5mice, ttest.est=ttest.est)
})
category_pwr_stat
#for the record, this is a way to make a table with pwr and t.test results
category_pwr_stat <- ddply(MLH1_data, "category", function(x) {
Nmice <- length( unique(x$mouse) )
mean.count <- mean(x$adj_nMLH1.foci)
sd.count <- sd(x$adj_nMLH1.foci)
cv <- sd.count/mean.count
ttest <- t.test(x$adj_nMLH1.foci, (20), alternative = "two", var.equal=TRUE)$p.value
ttestCI.lowr <- t.test(x$adj_nMLH1.foci, (20), alternative = "two", var.equal=TRUE)$conf.int[1]
ttestCI.upr <- t.test(x$adj_nMLH1.foci, (20), alternative = "two", var.equal=TRUE)$conf.int[2]
ttest.est <- t.test(x$adj_nMLH1.foci, (20), alternative = "two", var.equal=TRUE)$estimate
pwr5mice <- pwr.norm.test(d = (3/sd.count), n = 20, sig.level = 0.05, alternative = "two")$power
data.frame(Nmice=Nmice, cv.count = cv, ttest=ttest, CIlower = ttestCI.lowr,
CIupr = ttestCI.upr,
pwr = pwr5mice, ttest.est=ttest.est)
})
category_pwr_stat
bb
dat <- data.frame(
MLH1_sample = c(sample(PWD_m_example$nMLH1.foci, 10, replace=FALSE),  sample(PWD_m_example$nMLH1.foci, 15, replace=FALSE),    sample(PWD_m_example$nMLH1.foci, 20, replace=FALSE), sample(PWD_m_example$nMLH1.foci, 30, replace=FALSE), sample(PWD_m_example$nMLH1.foci, 35, replace=FALSE), sample(PWD_m_example$nMLH1.foci, 40, replace=FALSE) ),
samplesize = c(rep("10", 10), rep("15", 15), rep("20", 20), rep("30", 30), rep("35", 35), , rep("40", 40)) )
dat <- data.frame(
MLH1_sample = c(sample(PWD_m_example$adj_nMLH1.foci, 10, replace=FALSE),  sample(PWD_m_example$adj_nMLH1.foci, 15, replace=FALSE),    sample(PWD_m_example$adj_nMLH1.foci, 20, replace=FALSE), sample(PWD_m_example$adj_nMLH1.foci, 30, replace=FALSE), sample(PWD_m_example$adj_nMLH1.foci, 35, replace=FALSE), sample(PWD_m_example$adj_nMLH1.foci, 40, replace=FALSE)),
samplesize = c(rep("10", 10), rep("15", 15), rep("20", 20), rep("30", 30), rep("35", 35), , rep("40", 40)) )
dat <- data.frame(
MLH1_sample = c(sample(PWD_m_example$adj_nMLH1.foci, 10, replace=FALSE),  sample(PWD_m_example$adj_nMLH1.foci, 15, replace=FALSE),    sample(PWD_m_example$adj_nMLH1.foci, 20, replace=FALSE), sample(PWD_m_example$adj_nMLH1.foci, 30, replace=FALSE), sample(PWD_m_example$adj_nMLH1.foci, 35, replace=FALSE), sample(PWD_m_example$adj_nMLH1.foci, 40, replace=FALSE)),
samplesize = c(rep("10", 10), rep("15", 15), rep("20", 20), rep("30", 30), rep("35", 35), rep("40", 40)) )
bb <- ggplot(data = dat, aes(x=samplesize, y=MLH1_sample)) + geom_boxplot(aes(fill=samplesize))
bb
length(PWD_m_example$adj_nMLH1.foci)
p <- ggplot(MLH1_data,(aes(adj_nMLH1.foci,quality)))
p <- p + geom_point(stat = "identity")
p <- p  + geom_point(data = qual_means, colour="red")
p <- p + facet_wrap(~ category)
p
qual_means <- MLH1_data %>%
group_by(category, quality) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
p <- ggplot(MLH1_data,(aes(adj_nMLH1.foci,quality)))
p <- p + geom_point(stat = "identity")
p <- p  + geom_point(data = qual_means, colour="red")
p <- p + facet_wrap(~ category)
p
#make lattice / plots seperated by strain and sex
#facet
qual_means <- MLH1_data %>%
group_by(category, quality) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
p <- ggplot(MLH1_data,(aes(adj_nMLH1.foci,quality)))
p <- p + geom_point(stat = "identity")
p <- p  + geom_point(data = qual_means, colour="red")
p <- p + facet_wrap(~ category)
p
#make lattice / plots seperated by strain and sex
#facet
qual_means <- MLH1_data %>%
group_by(category, quality) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
p <- ggplot(MLH1_data,(aes(adj_nMLH1.foci,quality)))
p <- p + geom_point(stat = "identity")
p <- p  + geom_point(data = qual_means, colour="red")
p <- p + facet_wrap(~ category)
p
# do the same thing as above but geom_hist
histM <- ggplot(MLH1_data,(aes(adj_nMLH1.foci))) + xlim(c(16, 38))
histM <- histM + geom_histogram(stat = "bin", binwidth = 1)
histM <- histM + facet_wrap(~ category)
histM
df_list <- split(MLH1_data, as.factor(MLH1_data$category))
df_list
str(df_list)
length(df_list)
for(i in df_list){
print(head(i))
}
for(i in df_list){
print(length(i))
}
for(i in df_list){
print(length(i))
print(head(i$file.name))
}
for(i in df_list){
print((i))
print(head(i$file.name))
}
for(i in df_list){
print((df_list$i))
print(head(i$file.name))
}
str(df_list)
qual_means_ff <- df_list %>%
group_by(mouse) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
qual_means_ff <- df_list %>%
arrange(mouse) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
for(i in df_list){
i %>%
arrange(mouse) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
print((df_list$i))
print(head(i$file.name))
}
for(i in df_list){
i %>%
arrange(mouse) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
#  print((df_list$i))
# print(head(i$file.name))
}
for(i in df_list){
jj_i <-   i %>%
arrange(mouse) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
#  print((df_list$i))
# print(head(i$file.name))
}
View(jj_i)
PWD_female_df <- df_list$`PWD female`
p <- ggplot(PWD_female_df,(aes(adj_nMLH1.foci,quality)))
p <- p + geom_point(stat = "identity")
p <- p  + geom_point(data = qual_means, colour="red") +
p <- p + facet_wrap(~ category)
p <- ggplot(PWD_female_df,(aes(adj_nMLH1.foci,quality)))
p <- p + geom_point(stat = "identity")
p <- p  + geom_point(data = qual_means, colour="red") + geom_jitter()
p <- p + facet_wrap(~ mouse)
p
View(PWD_m_example)
View(PWD_female_df)
p <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
p <- p + geom_point(stat = "identity")
p <- p  + geom_point(data = qual_means, colour="red") + geom_jitter()
p <- p + facet_wrap(~ mouse)
p
p <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
p <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
p <- p + geom_point(stat = "identity")+ geom_jitter()
p <- p + facet_wrap(~ mouse)
p
m <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
m <- m + geom_point(stat = "identity")+ geom_jitter()
m <- m + facet_wrap(~ mouse)
m
PWD_female_df <- PWD_female_df[ is.na(PWD_female_df$quality) , ]
m <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
m <- m + geom_point(stat = "identity")+ geom_jitter()
m <- m + facet_wrap(~ mouse)
m
PWD_female_df <- df_list$`PWD female`
PWD_female_df <- PWD_female_df[ !is.na(PWD_female_df$quality) , ]
View(PWD_female_df)
m <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
m <- m + geom_point(stat = "identity")+ geom_jitter()
m <- m + facet_wrap(~ mouse)
m
PWD_female_df <- PWD_female_df[ !is.na(PWD_female_df$quality), ]
PWD_female_df <- PWD_female_df[!apply(is.na(PWD_female_df$quality) | PWD_female_df$quality == "", 1, all),]
PWD_female_df <- PWD_female_df[!apply(PWD_female_df == "", 1, all),]
PWD_female_df <- PWD_female_df[!apply(PWD_female_df == " ", 1, all),]
View(PWD_female_df)
PWD_female_df <- PWD_female_df[!apply(PWD_female_df$quality == " ", 1, all),]
PWD_female_df[!(is.na(PWD_female_df$$quality) | PWD_female_df$$quality==""), ]
PWD_female_df[!(is.na(PWD_female_df$quality) | PWD_female_df$$quality==""), ]
PWD_female_df[!(is.na(PWD_female_df$quality) | PWD_female_df$quality==""), ]
PWD_female_df <- PWD_female_df[!(is.na(PWD_female_df$quality) | PWD_female_df$quality==""), ]
m <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
m <- m + geom_point(stat = "identity")+ geom_jitter()
m <- m + facet_wrap(~ mouse)
m
#TODO, break down dataframes by category...
df_list <- split(MLH1_data, as.factor(MLH1_data$category))
#each of the indiviual dataframes can be acessed with df_list$ ---- category
# for each sub-data frame, make mouse specific table,
#
PWD_female_df <- df_list$`PWD female`
PWD_female_df <- PWD_female_df[!(is.na(PWD_female_df$quality) | PWD_female_df$quality==""), ]
m <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
m <- m + geom_point(stat = "identity")+ geom_jitter()
m <- m + facet_wrap(~ mouse)
m
PWD_male_df <- df_list$`PWD male`
PWD_male_df <- PWD_male_df[!(is.na(PWD_male_df$quality) | PWD_male_df$quality==""), ]
pm <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pm <- pm + geom_point(stat = "identity")+ geom_jitter()
pm <- pm + facet_wrap(~ mouse)
pm
WSB_female_df <- df_list$`WSB female`
WSB_female_df <- WSB_female_df[!(is.na(WSB_female_df$quality) | WSB_female_df$quality==""), ]
wf <- ggplot(WSB_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
wf <- wf + geom_point(stat = "identity")+ geom_jitter()
wf <- wf + facet_wrap(~ mouse)
wf
WSB_male_df <- df_list$`WSB male`
WSB_male_df <- WSB_male_df[!(is.na(WSB_male_df$quality) | WSB_male_df$quality==""), ]
wm <- ggplot(WSB_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
wm <- wm + geom_point(stat = "identity")+ geom_jitter()
wm <- wm + facet_wrap(~ mouse)
wm
G_male_df <- df_list$`G male`
G_male_df <- G_male_df[!(is.na(G_male_df$quality) | G_male_df$quality==""), ]
gm <- ggplot(G_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
gm <- gm + geom_point(stat = "identity")+ geom_jitter()
gm <- gm + facet_wrap(~ mouse)
gm
G_female_df <- df_list$`G female`
G_female_df <- G_female_df[!(is.na(G_female_df$quality) | G_female_df$quality==""), ]
gf <- ggplot(G_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
gf <- gf + geom_point(stat = "identity")+ geom_jitter()
gf <- gf + facet_wrap(~ mouse)
gf
unique(MLH1_data$category)
#TODO, break down dataframes by category...
df_list <- split(MLH1_data, as.factor(MLH1_data$category))
#each of the indiviual dataframes can be acessed with df_list$ ---- category
# for each sub-data frame, make mouse specific table,
#
PWD_female_df <- df_list$`PWD female`
PWD_female_df <- PWD_female_df[!(is.na(PWD_female_df$quality) | PWD_female_df$quality==""), ]
m <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
m <- m + geom_point(stat = "identity")+ geom_jitter()
m <- m + facet_wrap(~ mouse)
m
PWD_male_df <- df_list$`PWD male`
PWD_male_df <- PWD_male_df[!(is.na(PWD_male_df$quality) | PWD_male_df$quality==""), ]
pm <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pm <- pm + geom_point(stat = "identity")+ geom_jitter()
pm <- pm + facet_wrap(~ mouse)
pm
WSB_female_df <- df_list$`WSB female`
WSB_female_df <- WSB_female_df[!(is.na(WSB_female_df$quality) | WSB_female_df$quality==""), ]
wf <- ggplot(WSB_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
wf <- wf + geom_point(stat = "identity")+ geom_jitter()
wf <- wf + facet_wrap(~ mouse)
wf
WSB_male_df <- df_list$`WSB male`
WSB_male_df <- WSB_male_df[!(is.na(WSB_male_df$quality) | WSB_male_df$quality==""), ]
wm <- ggplot(WSB_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
wm <- wm + geom_point(stat = "identity")+ geom_jitter()
wm <- wm + facet_wrap(~ mouse)
wm
G_male_df <- df_list$`G male`
G_male_df <- G_male_df[!(is.na(G_male_df$quality) | G_male_df$quality==""), ]
gm <- ggplot(G_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
gm <- gm + geom_point(stat = "identity")+ geom_jitter()
gm <- gm + facet_wrap(~ mouse)
gm
G_female_df <- df_list$`G female`
G_female_df <- G_female_df[!(is.na(G_female_df$quality) | G_female_df$quality==""), ]
gf <- ggplot(G_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
gf <- gf + geom_point(stat = "identity")+ geom_jitter()
gf <- gf + facet_wrap(~ mouse)
gf
LEW_female_df <- df_list$`LEWES female`
LEW_female_df <- LEW_female_df[!(is.na(LEW_female_df$quality) | LEW_female_df$quality==""), ]
lf <- ggplot(LEW_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
lf <- lf + geom_point(stat = "identity")+ geom_jitter()
lf <- lf + facet_wrap(~ mouse)
lf
LEW_male_df <- df_list$`LEWES male`
LEW_male_df <- LEW_male_df[!(is.na(LEW_male_df$quality) | LEW_male_df$quality==""), ]
lm <- ggplot(LEW_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
lm <- lm + geom_point(stat = "identity")+ geom_jitter()
lm <- lm + facet_wrap(~ mouse)
lm
MSM_female_df <- df_list$`MSM female`
MSM_female_df <- MSM_female_df[!(is.na(MSM_female_df$quality) | MSM_female_df$quality==""), ]
mf <- ggplot(MSM_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
mf <- mf + geom_point(stat = "identity")+ geom_jitter()
mf <- mf + facet_wrap(~ mouse)
mf
MSM_male_df <- df_list$`MSM male`
MSM_male_df <- MSM_male_df[!(is.na(MSM_male_df$quality) | MSM_male_df$quality==""), ]
mm <- ggplot(MSM_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
mm <- mm + geom_point(stat = "identity")+ geom_jitter()
mm <- mm + facet_wrap(~ mouse)
mm
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) )
pf <- pf + facet_wrap(~ mouse)
pf
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) ) #strain mean line
pf <- pf + facet_wrap(~ mouse) + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) )
pf
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) ) #strain mean line
pf <- pf + facet_wrap(~ mouse) + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci), color="red" ) )
pf
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) ) #strain mean line
pf <- pf + facet_wrap(~ mouse) + geom_hline(yintercept = mean(PWD_female_df$adj_nMLH1.foci), color="red" )
pf
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) ) #strain mean line
pf <- pf + facet_wrap(~ mouse) + geom_hline(yintercept = mean(adj_nMLH1.foci), color="red" )
qual_means_pf <- PWD_female_df %>%
group_by(mouse) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) ) #strain mean line
pf <- pf + facet_wrap(~ mouse) + geom_hline(yintercept = mean(qual_means_pf$adj_nMLH1.foci), color="red" )
pf
qual_means_pf
qual_means_pf <- PWD_female_df %>%
arrange(mouse) %>%
summarise(
adj_nMLH1.foci = mean(adj_nMLH1.foci)
)
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) ) #strain mean line
pf <- pf + facet_wrap(~ mouse) + geom_hline(yintercept = mean(qual_means_pf$adj_nMLH1.foci), color="red" )
pf
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ) ) #strain mean line
pf <- pf + geom_hline(yintercept = mean(qual_means_pf$adj_nMLH1.foci), color="red" )
pf <- pf + facet_wrap(~ mouse)
pf
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ), color="black" ) #strain mean line
pf <- pf + geom_hline(yintercept = mean(qual_means_pf$adj_nMLH1.foci), color="red" )
pf <- pf + facet_wrap(~ mouse)
pf
qual_means_pf
qual_means_pf <- ddply(PWD_female_df, .(mouse), summarise,
m_nMLH1 = mean(adj_nMLH1.foci)
)
qual_means_pf
qual_means_pf
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ), color="black" ) #strain mean line
pf <- pf + geom_hline(yintercept = mean(qual_means_pf$adj_nMLH1.foci), color="red" )
pf <- pf + facet_wrap(~ mouse)
pf
pf <- ggplot(PWD_female_df,(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_point(stat = "identity")+ geom_jitter()
pf <- pf + geom_hline(yintercept = c( mean(PWD_female_df$adj_nMLH1.foci) ), color="black" ) #strain mean line
pf <- pf + geom_hline(yintercept = mean(qual_means_pf$m_nMLH1), color="red" )
pf <- pf + facet_wrap(~ mouse)
pf
PWD_male_df <- df_list$`PWD male`
PWD_male_df <- PWD_male_df[!(is.na(PWD_male_df$quality) | PWD_male_df$quality==""), ]
qual_means_pm <- ddply(PWD_male_df, .(mouse), summarise,
m_nMLH1 = mean(adj_nMLH1.foci)
)
pm <- ggplot(PWD_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
pm <- pm + geom_point(stat = "identity")+ geom_jitter()
pm <- pm + geom_hline(yintercept = mean(qual_means_pm$m_nMLH1), color="red" )
pm <- pm + facet_wrap(~ mouse) +
pm
pm <- ggplot(PWD_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
pm <- pm + geom_point(stat = "identity")+ geom_jitter()
pm <- pm + geom_hline(yintercept = mean(qual_means_pm$m_nMLH1), color="red" )
pm <- pm + facet_wrap(~ mouse)
pm
PWD_male_df <- df_list$`PWD male`
PWD_male_df <- PWD_male_df[!(is.na(PWD_male_df$quality) | PWD_male_df$quality==""), ]
qual_means_pm <- ddply(PWD_male_df, .(mouse), summarise,
m_nMLH1 = mean(adj_nMLH1.foci)
)
pm <- ggplot(PWD_male_df,(aes(y= adj_nMLH1.foci, x= quality)))
pm <- pm + geom_point(stat = "identity")+ geom_jitter()
pm <- pm + geom_hline(yintercept = mean(qual_means_pm$m_nMLH1), color="red" )
pm <- pm + facet_wrap(~ mouse)
pm
df_list[1]
for(i in df_list){
print(head(i[i]))
}
for(i in length(df_list)){
print(head(df_list[i]))
}
for(i in length(df_list)){
# print(head(df_list[i]))
df_list[i] <- df_list[i][!(is.na(df_list[i]$quality) | df_list[i]$quality==""), ]
}
io
i
str(df_list[i])
str(df_list[i]$i)
str(df_list[i]$df_list[i])
str(df_list[i]$df_list[i][i])
str(df_list[i]$[i])
str(df_list[i][i])
str(df_list[[i]])
for(i in length(df_list)){
# print(head(df_list[i]))
df_list[[i]] <- df_list[[i]][!(is.na(df_list[[i]]$quality) | df_list[[i]]$quality==""), ]
}
for(i in length(df_list)){
# print(head(df_list[i]))
df_list[[i]] <- df_list[[i]][!(is.na(df_list[[i]]$quality) | df_list[[i]]$quality==""), ]
df_list[[i]]$mouse_mean <- qual_means_pf <- ddply(df_list[[i]], .(mouse), summarise,
mouse_nMLH1 = mean(adj_nMLH1.foci)
)
}
for(i in length(df_list)){
# print(head(df_list[i]))
df_list[[i]] <- df_list[[i]][!(is.na(df_list[[i]]$quality) | df_list[[i]]$quality==""), ]
qual_means_pf <- ddply(df_list[[i]], .(mouse), summarise,
mouse_nMLH1 = mean(adj_nMLH1.foci)
)
# df_list[[i]]$mouse_mean
}
for(i in length(df_list)){
# print(head(df_list[i]))
df_list[[i]] <- df_list[[i]][!(is.na(df_list[[i]]$quality) | df_list[[i]]$quality==""), ]
sub_mouse_means <- ddply(df_list[[i]], .(mouse), summarise,
mouse_nMLH1 = mean(adj_nMLH1.foci)
)
#match the mouse mean to mouse
df_list[[i]]$mouse_mean <- sub_mouse_means$mouse_nMLH1
}
sub_mouse_means
df_list[[i]]
sub_mouse_means
match(sub_mouse_means$mouse == df_list[[i]]$mouse)
for(i in length(df_list)){
# print(head(df_list[i]))
df_list[[i]] <- df_list[[i]][!(is.na(df_list[[i]]$quality) | df_list[[i]]$quality==""), ]
sub_mouse_means <- ddply(df_list[[i]], .(mouse), summarise,
mouse_nMLH1 = mean(adj_nMLH1.foci)
)
#match the mouse mean to mouse  sub_mouse_means$mouse == df_list[[i]]$mouse
df_list[[i]]$mouse_mean <- ifelse(sub_mouse_means$mouse == df_list[[i]]$mouse, df$mouse_nMLH1, NA)  #currently this just repeats the sequence
}
for(i in length(df_list)){
# print(head(df_list[i]))
df_list[[i]] <- df_list[[i]][!(is.na(df_list[[i]]$quality) | df_list[[i]]$quality==""), ]
sub_mouse_means <- ddply(df_list[[i]], .(mouse), summarise,
mouse_nMLH1 = mean(adj_nMLH1.foci)
)
#match the mouse mean to mouse  sub_mouse_means$mouse == df_list[[i]]$mouse
df_list[[i]]$mouse_mean <- ifelse(sub_mouse_means$mouse == df_list[[i]]$mouse, sub_mouse_means$mouse_nMLH1, NA)  #currently this just repeats the sequence
}
df_list[[i]]
df_list[[i]]
