names(new_dat[[1]]) <- c('mousey')
new_dat
names(new_dat$mouse1) <- c('mousey')
new_dat
new_dat = list()
for(i in 1:(length(cat_list))){
#I should be the specific mice in the DFs
new_dat[[i]] <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 15) ,    sample(cat_list[[i]]$nMLH1.foci, 15))$p.value )
}
names(new_dat) <- cat_list[[i]]$mouse
names(new_dat) <- unique(cat_list[[i]]$mouse)
new_dat
new_dat = list()
for(i in 1:(length(cat_list))){
#I should be the specific mice in the DFs
new_dat[[i]] <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 15) ,    sample(cat_list[[i]]$nMLH1.foci, 15))$p.value )
names(new_dat) <- unique(cat_list[[i]]$mouse)
}
new_dat
cat_list
names(cat_list)
new_dat = list()
for(i in 1:(length(cat_list))){
#I should be the specific mice in the DFs
new_dat[[i]] <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 15) ,    sample(cat_list[[i]]$nMLH1.foci, 15))$p.value )
names(new_dat) <- names(cat_list)
}
for(i in 1:(length(cat_list))){
#I should be the specific mice in the DFs
new_dat[[i]] <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 15) ,    sample(cat_list[[i]]$nMLH1.foci, 15))$p.value )
}
names(new_dat) <- names(cat_list)
new_dat
plot_list = list()
for (h in 1:length(new_dat)) {
pf <- ggplot(new_dat,(aes(x=new_dat[[h]])))
pf <- pf + geom_histogram() + xlim(c(0,1))
#  pf <- pf + geom_jitter(width = 0.25, aes(colour = factor(Batch)) )
pf <- pf + facet_wrap(~ mouse)
plot_list[[h]] =   pf
}
for (h in 1:length(new_dat)) {
pf <- ggplot(new_dat[h],(aes(x=new_dat[[h]])))
pf <- pf + geom_histogram() + xlim(c(0,1))
#  pf <- pf + geom_jitter(width = 0.25, aes(colour = factor(Batch)) )
pf <- pf + facet_wrap(~ mouse)
plot_list[[h]] =   pf
}
str(new_dat)
g <- as.data.frame(new_dat)
g
new_dat
for (h in 1:length(new_dat)) {
pf <- ggplot(g)
pf <- pf + geom_histogram() + xlim(c(0,1))
#  pf <- pf + geom_jitter(width = 0.25, aes(colour = factor(Batch)) )
pf <- pf + facet_wrap(~ mouse)
plot_list[[h]] =   pf
}
for (gg in 1:length(plot_list) ){
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
pf
plot_list
pf <- ggplot(g)
pf <- pf + geom_histogram() + xlim(c(0,1))
pf
g
plot_list = list()
for(h in 1:length(colnames(g)))
pf <- ggplot(g, aes(colnames(g)[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[[h]] =   pf
pf
plot_list
for(h in 1:length(colnames(g)))
pf <- ggplot(g, aes(colnames(g)[h]))
pf <- pf + geom_histogram()# + xlim(c(0,1))
plot_list[[h]] =   pf
pf
for (gg in 1:length(plot_list) ){
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
g
colnames(g)[h]
for(h in 1:length(colnames(g)))
pf <- ggplot(g, aes(g$colnames(g)[h]))
pf <- pf + geom_histogram()# + xlim(c(0,1))
plot_list[[h]] =   pf
pf
for (gg in 1:length(plot_list) ){
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
gcolnames <- colnames(g)
gcolnames <- colnames(g)
g$gcolnames[h]
g$gcolnames[1]
gcolnames[1]
g[h]
for(h in 1:length(gcolnames))
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram()# + xlim(c(0,1))
plot_list[[h]] =   pf
pf
for (gg in 1:length(plot_list) ){
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list
for(h in 1:length(gcolnames))
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram()# + xlim(c(0,1))
plot_list[h] =   pf
pf
for (gg in 1:length(plot_list) ){
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list
plot_list = list()
rm(plot_list)
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram()# + xlim(c(0,1))
plot_list[h] <-   pf
pf
}
plot_list
pf
plot_list[1]
for(h in 1:length(gcolnames)){
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[h] <-   pf
pf
}
pf
pf
plot_list = list()
rm(plot_list)
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[[h]] <-   pf
pf
}
plot_list
for (gg in 1:length(plot_list) ){
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list[1]
plot_list[2]
for (h in 1:length(new_dat)) {
pf <- ggplot(g)
pf <- pf + geom_histogram() + xlim(c(0,1))
#  pf <- pf + geom_jitter(width = 0.25, aes(colour = factor(Batch)) )
#pf <- pf + facet_wrap(~ mouse)
plot_list[[h]] =   pf
}
plot_list
rm(plot_list)
plot_list = data.frame()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[[h]] <-   pf
pf
}
plot_list = data.frame()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[h] <-   pf
pf
}
plot_list = list()
for(h in 1:length(gcolnames)){
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[h] <-   pf
pf
}
plot_list
pf <- ggplot(g, aes(x = g[2]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf
pf <- ggplot(g, aes(x = g[1]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf
plot_list[1] <-   pf
plot_list
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[[h]] =   pf
pf
}
for (gg in 1:length(plot_list) ){
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[[h]] =   pf
pf
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list
g
pMLH1_data <- MLH1_data[MLH1_data$category == "PWD male", ]
cat_list <- split(pMLH1_data, (pMLH1_data$mouse))
o=0
i=0
new_dat = list()
for(i in 1:(length(cat_list))){
new_dat[[i]] <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 15) ,    sample(cat_list[[i]]$nMLH1.foci, 15))$p.value )
}
new_dat = list()
for(i in 1:(length(cat_list))){
new_dat[[i]] <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 5) ,    sample(cat_list[[i]]$nMLH1.foci, 5))$p.value )
}
names(new_dat) <- names(cat_list)
g <- as.data.frame(new_dat)
g
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
plot_list[[h]] =   pf
pf
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf <- pf + facet_wrap(~ mouse) + geom_hline(aes(yintercept = mouse_mean_MLH1), color="red")
plot_list[[h]] =   pf
pf
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf <- pf + facet_wrap(~ mouse)
plot_list[[h]] =   pf
pf
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf <- pf + facet_wrap(~ Original.Name)
plot_list[[h]] =   pf
pf
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g[[h]], aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf <- pf + facet_wrap(~ mouse)
plot_list[[h]] =   pf
pf
}
g[[h]]
g
names(g)
colnames(g)
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g[[h]], aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf <- pf + facet_wrap(~ colnames(g))
plot_list[[h]] =   pf
pf
}
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf <- pf + facet_wrap(~ colnames(g))
plot_list[[h]] =   pf
pf
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf <- pf + facet_wrap(~ colnames(g))
plot_list[h] =   pf
pf
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h]))
pf <- pf + geom_histogram() + xlim(c(0,1))
pf <- pf + facet_wrap(~ colnames(g))
plot_list[[h]] =   pf
pf
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
g
pf <- ggplot(g, aes(x = g[1])) + geom_histogram() + xlim(c(0,1))
pf
pf <- ggplot(g, aes(x = g[5])) + geom_histogram() + xlim(c(0,1))
pf
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h])) + geom_histogram() + xlim(c(0,1))
plot_list[[h]] =   pf
#
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list[1]
plot_list[2]
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h])) + geom_histogram() + xlim(c(0,1))
plot_list[h][1] =   pf
#
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list
str(plot_list)
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h])) + geom_histogram() + xlim(c(0,1))
plot_list[h] =   pf
#
}
for (gg in 1:length(plot_list) ){
print(gg)
show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
for (gg in 1:length(plot_list) ){
print(gg)
plot_list[gg]
#show(plot_list[gg])
#invisible(lapply(obj, function(x) plot(x,main="some plot")))
}
plot_list[4]
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h])) + geom_histogram() + xlim(c(0,1))
plot_list[[h]] =   pf
#
}
plot_list[1]
plot_list[3][[1]]
plot_list[6][[1]]
plot_list = list()
gcolnames <- colnames(g)
for(h in 1:length(gcolnames)){
print(h)
pf <- ggplot(g, aes(x = g[h])) + geom_histogram() + xlim(c(0,1))
pf
plot_list[[h]] =   pf
}
pf
h
ggplot(g, aes(x = g[7])) + geom_histogram() + xlim(c(0,1))
ggplot(g, aes(x = g[6])) + geom_histogram() + xlim(c(0,1))
plot_list = list()
for (h in 1:length(df_list)) {
pf <- ggplot(df_list[[h]],(aes(y= adj_nMLH1.foci, x= quality)))
pf <- pf + geom_jitter(width = 0.25, aes(colour = factor(Batch)) )
pf <- pf + geom_hline(yintercept = c( mean(df_list[[h]]$adj_nMLH1.foci) ), color="black" )
pf <- pf + facet_wrap(~ mouse) + geom_hline(aes(yintercept = mouse_mean_MLH1), color="red")
plot_list[[h]] =   pf
}
for(h in 1:length(gcolnames)){
print(h) }
new_dat = data.frame(m = c(1), pvals = as.numeric(c(1)) )
for(i in 1:(length(cat_list))){
new_dat$pvals <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 5) ,    sample(cat_list[[i]]$nMLH1.foci, 5))$p.value )
}
new_dat = data.frame(m = c(1), pvals = as.numeric(c(1)) )
for(i in 1:(length(cat_list))){
new_dat$pvals <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 5) ,    sample(cat_list[[i]]$nMLH1.foci, 5))$p.value )
new_dat$m <- cat_list[[i]]$mouse
}
for(i in 1:(length(cat_list))){
new_dat$pvals <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 5) ,    sample(cat_list[[i]]$nMLH1.foci, 5))$p.value )
new_dat$m <- cat_list[[i]]$mouse
}
str(new_dat)
new_dat = list()
for(i in 1:(length(cat_list))){
new_dat[i] <- data.frame()
new_dat[i]$pvals <- replicate(100, t.test(sample(cat_list[[i]]$nMLH1.foci, 5) ,    sample(cat_list[[i]]$nMLH1.foci, 5))$p.value )
new_dat$m <- cat_list[[i]]$mouse
}
AP_mouse_table <- ddply(MLH1_data, c("mouse"), summarise,
Nmice = length(unique(mouse)),
Ncells  = length(nMLH1.foci),
mean_co = format(round(  mean(nMLH1.foci), 3 ), nsmall=3),
var = format(round(   var(nMLH1.foci),3), nsmall=3),
sd   = round(sd(nMLH1.foci), 3),
se   = round(sd / sqrt(Ncells), 3)
)
AP_mouse_table
library(raster)#for cV
install.packages("raster")
library(raster)#for cV
AP_mouse_table <- ddply(MLH1_data, c("mouse"), summarise,
Nmice = length(unique(mouse)),
Ncells  = length(adj_nMLH1.foci),
mean_co = format(round(  mean(adj_nMLH1.foci), 3 ), nsmall=3),
cV = cv(adj_nMLH1.foci),
var = format(round(   var(adj_nMLH1.foci),3), nsmall=3),
sd   = round(sd(adj_nMLH1.foci), 3),
se   = round(sd / sqrt(Ncells), 3)
)
AP_mouse_table
plot(AP_mouse_table$cV, AP_mouse_table$Ncells)
AP_mouse_table <- add_sex(AP_mouse_table)
AP_mouse_table
table(AP_mouse_table$Ncells)
hist(AP_mouse_table$Ncells)
twenty <- AP_mouse_table[AP_mouse_table$Ncells > 20,]
lessTwenty <- AP_mouse_table[AP_mouse_table$Ncells < 20,]
twenty
twenty
lessTwenty
length(lessTwenty)
length(lessTwenty$mouse)
length(twenty$mouse)
