mean = mean(nMLH1_foci),
var = var(nMLH1_foci),#this is very large within mouse
sd   = sd(nMLH1_foci)
#se   = sd / sqrt(N)
)
category_numbers
IFDdata_ = read.csv("C:/Users/alpeterson7/Documents/HannahVR/BD_F2_RecombinationPhenotypes.csv", header=TRUE)
data_HVR_full = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_Aug17.csv", header=TRUE)
boxplot(IFD~Cross, data=data, main = "boxplots of IF measurements, F2 comparisons")
View(data)
data_HVR_full = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_Aug17.csv", header=TRUE)
View(IFDdata_HVR_full)
View(IFDdata_HVR_full)
data_HVR_full = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_Aug17.csv", header=TRUE)
View(data_HVR_full)
boxplot(IFD~Cross, data=data_HVR_full, main = "boxplots of IF measurements, F2 comparisons")
View(data_HVR_full)
boxplot(IFD~Animal.ID, data=data_HVR_full, main = "boxplots of IF measurements")
max(data_HVR_full$IFD)
min(data_HVR_full$IFD)
head(data_HVR_full$IFD)
str(data_HVR_full)
max(data_HVR_full$IFD, na.rm=TRUE)
data2 <- which(with( data_HVR_full, IFD < 1000 ))
data_HVR_full <- data_HVR_full[-data2, ]
View(data_HVR_full)
data_HVR_full = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_Aug17.csv", header=TRUE)
new.data <- data_HVR_full %>% filter(!(IFD > 1000) )
library(dplyr)
new.data <- data_HVR_full %>% filter(!(IFD > 1000) )
View(new.data)
outliers <- data_HVR_full %>% filter((IFD > 1000) )
View(outliers)
boxplot(IFD~Cross, data=data_HVR_full, main = "boxplots of IF measurements, F2 comparisons")
boxplot(IFD~Cross, data=new.data, main = "boxplots of IF measurements, F2 comparisons")
boxplot(IFD~Animal.ID, data=new.data, main = "boxplots of IF measurements")
boxplot(IFD~Cross, data=new.data, main = "boxplots of IF measurements, F2 comparisons")
boxplot(IFD~Animal.ID, data=new.data, main = "boxplots of IF measurements")
BDdata_F2 = read.csv("C:/Users/alpeterson7/Documents/HannahVR/BD_F2_RecombinationPhenotypes.csv", header=TRUE)
View(BDdata_F2)
mergd <- merge(data_HVR_full, BD_MLH1_data, by.x=ANIMAL.ID, by.y=ANIMAL_ID)
mergd <- merge(data_HVR_full, BDdata_F2, by.x=ANIMAL.ID, by.y=ANIMAL_ID)
mergd <- merge(data_HVR_full, BDdata_F2, by.x=Animal.ID, by.y=ANIMAL_ID)
mergd <- merge(data_HVR_full, BDdata_F2, by.x=Animal.ID, by.y=ANIMAL_ID)
View(data_HVR_full)
mergd <- merge(data_HVR_full, BDdata_F2, by.y=ANIMAL_ID)
mergd <- merge(data_HVR_full, BDdata_F2, by.x=ANIMAL_ID)
mergd <- merge(data_HVR_full, BDdata_F2, by.x=Animal.ID)
mergd <- merge.data.frame(data_HVR_full, BDdata_F2, by.x = Animal.ID)
mergd <- merge.data.frame(data_HVR_full, BDdata_F2, by = "Animal.ID")
mergd <- merge.data.frame(data_HVR_full, BDdata_F2, by.x = "Animal.ID")
mergd <- merge.data.frame(data_HVR_full, BDdata_F2, by.x = "Animal.ID", by.y = "ANIMAL_ID")
View(mergd)
mergd <- merge.data.frame(data_HVR_full, BDdata_F2, by.x = "Animal.ID", by.y = "ANIMAL_ID", all=FALSE)
View(mergd)
library(ggplot2)
library(ggplot2)
library(gridExtra)
library(pwr)
library(plyr)
library(dplyr)
IFDdata_ = read.csv("C:/Users/alpeterson7/Documents/HannahVR/BD_F2_RecombinationPhenotypes.csv", header=TRUE)
data_HVR_full = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_Aug17.csv", header=TRUE)
View(data_HVR_full)
}
for(i in 1:length(data_HVR_full$Animal.ID)){
mouse_list = strsplit(as.character(data_HVR_full$Animal.ID[i]), split="_")[[1]]
data_HVR_full$mouse[i] = mouse_list[1]
}
outliers <- data_HVR_full %>% filter((IFD > 1000) )
View(outliers)
new.data <- data_HVR_full %>% filter(!(IFD > 1000) )
boxplot(IFD~Cross, data=new.data, main = "boxplots of IF measurements, F2 comparisons")
boxplot(IFD~Animal.ID, data=new.data, main = "boxplots of IF measurements")
BDdata_F2 = read.csv("C:/Users/alpeterson7/Documents/HannahVR/BD_F2_RecombinationPhenotypes.csv", header=TRUE)
BDdata_F2$ANIMAL_ID <- as.factor(BDdata_F2$ANIMAL_ID)
#seprate by mouse, calculate average within mouse var  and average between mouse var
BDdata_P0 = read.csv("C:/Users/alpeterson7/Documents/HannahVR/BD_MLH1_CASTxPWD_P0.csv", header=TRUE)
BD_MLH1_data = rbind(BDdata_F2, BDdata_P0)
View(BDdata_P0)
View(data_HVR_full)
levels(data_HVR_full$Cross)
data_HRV_P0 = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_P0_Aug17.csv", header=TRUE)
data_HRV_P0 = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_P0_Aug17.csv", header=TRUE)
data_HRV_P0 = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_P0_Aug17.csv", header=TRUE)
data_HRV_P0 = read.csv("C:/Users/alpeterson7/Documents/HannahVR/HVR_IFD_DATA_P0_Aug17.csv", header=TRUE)
View(data_HRV_P0)
P0_IFD <- ddply(data_HVR_P0, .(Strain), summarize,
N_IFD = sum(Foci.interfocal.distance..pixel.)
)
P0_IFD <- ddply(data_HRV_P0, .(Strain), summarize,
N_IFD = sum(Foci.interfocal.distance..pixel.)
)
P0_IFD
P0_IFD <- ddply(data_HRV_P0, .(Strain), summarize,
N_IFD = length(Foci.interfocal.distance..pixel.),
mean_IFD = mean(Foci.interfocal.distance..pixel.)
)
P0_IFD
P0_IFD$mean_IFD[3]
View(new.data)
ifd = ggplot(data =new.data, aes(x= category2, fill= as.factor(Cross),
+  geom_boxplot(aes(x= mouse, y=IFD) )
ifd
ifd = ggplot(data =new.data, aes(x= category2, fill= as.factor(Cross) )+
geom_boxplot(aes(x= mouse, y=IFD) )
ifd
ifd = ggplot(data =new.data, aes(x= category2, fill= as.factor(Cross) ) )
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) )
two_groups <- transform(new.data, category2 = factor(paste(mouse, IFD)))
two_groups <- transform(two_groups, category2 = reorder(category2, rank(IFD)))
ifd = ggplot(data =two_groups, aes(x= category2, fill= as.factor(Cross), group="Cross"))
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) )
ifd = ggplot(data =two_groups, aes(x= category2, fill= as.factor(Cross)) )
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) )
P0_IFD
ifd = ggplot(data =two_groups, aes(x= category2, fill= as.factor(Cross)) )
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) ) + geom_hline(yintercept = c(P0_IFD$mean_IFD[1],P0_IFD$mean_IFD[3] ) )
two_groups <- transform(new.data, category2 = factor(paste(Animal.ID, Intra.Cell.SC.Reference.Number, IFD)))
two_groups <- transform(two_groups, category2 = reorder(category2, rank(IFD)))
ifd = ggplot(data =two_groups, aes(x= category2, fill= as.factor(Cross)) )
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) ) + geom_hline(yintercept = c(P0_IFD$mean_IFD[1],P0_IFD$mean_IFD[3] ) )
View(two_groups)
ifd = ggplot(data =two_groups, aes(x= category2, y=IFD, fill= as.factor(Cross)) )
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) ) + geom_hline(yintercept = c(P0_IFD$mean_IFD[1],P0_IFD$mean_IFD[3] ) )
new.data <- new_data[order(new_data$IFD),]
new.data <- new.data[order(new.data$IFD),]
ifd = ggplot(data =two_groups, aes(x= ANIMAL_ID, y=IFD, fill= as.factor(Cross)) )
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) ) + geom_hline(yintercept = c(P0_IFD$mean_IFD[1],P0_IFD$mean_IFD[3] ) )
View(new.data)
new.data = reorder(new.data$Cross, new.data$IFD, mean)
ifd = ggplot(data =two_groups, aes(x= ANIMAL_ID, y=IFD, fill= as.factor(Cross)) )
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) ) + geom_hline(yintercept = c(P0_IFD$mean_IFD[1],P0_IFD$mean_IFD[3] ) )
new.data = reorder(new.data$Animal.ID, new.data$IFD, mean)
new.data <- data_HVR_full %>% filter(!(IFD > 1000) )
new.data = reorder(new.data$Animal.ID, new.data$IFD, mean)
View(IFDdata_)
new.data <- data_HVR_full %>% filter(!(IFD > 1000) )
ord.new.data = reorder(new.data$mouse, new.data$IFD, mean)
ifd = ggplot(data =ord.new.data, aes(x= ANIMAL_ID, y=IFD, fill= as.factor(Cross)) )
ifd = ggplot(data =new.data, aes(x= ANIMAL_ID, y=IFD, fill= as.factor(Cross)) )
ifd  +  geom_boxplot(aes(x= mouse, y=IFD) ) + geom_hline(yintercept = c(P0_IFD$mean_IFD[1],P0_IFD$mean_IFD[3] ) )
cell_numbers_mouse <- ddply(data_HVR_full, .(ANIMAL_ID), summarize,
N_IFD = length(Foci.interfocal.distance..pixel.)
)
View(new.data)
View(data_HVR_full)
cell_numbers_mouse <- ddply(data_HVR_full, .(ANIMAL.ID), summarize,
N_IFD = length(Foci.interfocal.distance..pixel.)
)
cell_numbers_mouse <- ddply(data_HVR_full, .(mouse), summarize,
N_IFD = length(Foci.interfocal.distance..pixel.)
)
cell_numbers_mouse <- ddply(data_HVR_full, .(mouse), summarize,
N_IFD = length(IFD)
)
cell_numbers_mouse
cell_numbers_mouse <- ddply(data_HVR_full, .(mouse), summarize,
N_IFD = length(IFD),
max(Running.Cell.Count)
#number of cells / number of IFDs = proxy for proportion of 2COs
)
cell_numbers_mouse
cell_numbers_mouse <- ddply(data_HVR_full, .(mouse), summarize,
N_IFD = length(IFD),
ncells = max(Running.Cell.Count),
prcnt_2CO = N_IFD / (ncells*19)
#number of cells / number of IFDs = proxy for proportion of 2COs
)
cell_numbers_mouse
cell_numbers_mouse <- ddply(data_HVR_full, .(mouse), summarize,
N_IFD = length(IFD),
ncells = max(Running.Cell.Count),
n3CO = sum(X3.XO.Count.per.cell),
prcnt_2CO = N_IFD / (ncells*19)
#number of cells / number of IFDs = proxy for proportion of 2COs
)
cell_numbers_mouse
cell_numbers_mouse <- ddply(data_HVR_full, .(mouse), summarize,
N_IFD = length(IFD),
ncells = max(Running.Cell.Count),
n3CO = sum(max(X3.XO.Count.per.cell)), #not 3COs
prcnt_2CO = N_IFD / (ncells*19)
#number of cells / number of IFDs = proxy for proportion of 2COs
)
cell_numbers_mouse
boxplot(prcnt_2CO~mouse, data=mouse_data, main = "boxplots")
mouse_data <- ddply(data_HVR_full, .(mouse), summarize,
N_IFD = length(IFD),
ncells = max(Running.Cell.Count),
#3COs must be calculated by cell, not mouse
prcnt_2CO = N_IFD / (ncells*19)
#number of cells / number of IFDs = proxy for proportion of 2COs
)
boxplot(prcnt_2CO~mouse, data=mouse_data, main = "boxplots")
279 / (19*30)
View(BDdata_F2)
View(BDdata_F2)
library(devtools)
setRepositories(ind = 1:2) ## allow R to look for pacakges in both CRAN and Bioconductor
library(argyle)
library('lazyeval') ; library('tibble')
library(ggplot2)
cast_geno <- geno[ ,(samples(geno)$iid == "IN13" | samples(geno)$iid == "IN34" | samples(geno)$iid == "IN40" | samples(geno)$iid == "IN54") ]
install.packages("argyle")
library(argyle)
cast_geno <- geno[ ,(samples(geno)$iid == "IN13" | samples(geno)$iid == "IN34" | samples(geno)$iid == "IN40" | samples(geno)$iid == "IN54") ]
mus_geno <- geno[ ,(samples(geno)$iid == "BAG74u" | samples(geno)$iid == "CE502" | samples(geno)$iid == "RU:SAR_MUSC:40_298_Mu" | samples(geno)$iid == "Yu2097m" | samples(geno)$iid == "Yu2113m") ]
install.packages("argyle")
library(ggplot2)
setwd("C:/Users/alpeterson7/Documents/MLH1data/src/")
load(file="MLH1_data_setup.RData")  #
df$category <- factor(df$category,
levels =c( "CAST male",
"G female", "G male",
"WSB female", "WSB male", "LEWES female", 'LEWES male',
"PWD female", "PWD male", "MSM female", "MSM male"),
order=TRUE )
new_df <- MLH1_data[with(MLH1_data, order(category)), ]
library(plyr)
library(gplots)
library(ggplot2)
setwd("C:/Users/alpeterson7/Documents/MLH1data/Results/figures/")
load(file="MLH1_data_setup.RData")
MLH1_data$strain <- factor(MLH1_data$strain,
levels =c(  "G", "LEWES","WSB","PERA",
"PWD", "CZECHI",
"MSM",  "CAST","CIM",
"PANCEVO","CAROLI","RAT","Peromyscus","Microtus"), order=T )
MLH1_data$subsp <- factor(MLH1_data$subsp,
levels =c( "Dom", "Musc", "Musc-Cast",
"Cast", "Spic", "Caroli", "Outgroup", "other"), order=T )
MLH1_data <- with(MLH1_data, MLH1_data[order(subsp, strain),])
MLH1_by_F_strain <- MLH1_data[MLH1_data$sex == "female", ]
MLH1_by_M_strain <- MLH1_data[MLH1_data$sex == "male", ]
BD_data =  subset(MLH1_by_M_strain,  strain == "PERA" | strain == "CZECHI" | strain =="CIM" |  strain == "Peromyscus" |
strain == "PANCEVO" |  strain == "CAROLI" |  strain == "Microtus" | strain == "RAT" )
AP_data = subset(MLH1_by_M_strain, dataset == "AP")
MLH1_by_M_strain <- rbind(AP_data, BD_data)
MLH1_by_M_strain <- with(MLH1_by_M_strain, MLH1_by_M_strain[order(subsp, strain),])
setwd("C:/Users/alpeterson7/Documents/MLH1data/Results/figures/")
load(file="MLH1_data_setup.RData")
expansion=2
par(mfrow=c(1,1))
par(cex = 1)
plot(x = c(-5, 50), y = c(20,40),
main ="", xlab ="", ylab = "Female MLH1 Foci", axes = F, type = "n", font.axis = 4)
strain_x_axis_scaffold = c(-1, (length(MLH1_by_F_strain$N)*expansion) )
axis(side = 2, at = c(0,20,22,24,26,28,30,32,34,36), labels = c("",20,22,24,26,28,30,32,34, ""), lwd = 3, font.axis = 3)
nudge = 8
f_strain_xspacing <- seq(2,28, by=4)
plotCI(x = f_strain_xspacing,   #x values are the spacing
y = as.numeric(MLH1_by_F_strain$mean_co), #y values, female means
uiw = (as.numeric(MLH1_by_F_strain$se)*2),
col = c("#56B4E9","cadetblue4","cadetblue",
"coral1","red",  "#E69F00", "yellowgreen"),
pch = 16,  #shape
lwd = 2, gap = 0, sfrac = 0.01, add = TRUE, cex=1.5)#cex controls point size
segments(((length(MLH1_by_F_strain$N)*expansion)*.23)-nudge, 20.5,
x1 =((length(MLH1_by_F_strain$N)*expansion)*.28)-nudge, y1 = 20.5, lwd=3)#dom
text(-3,20, "M.m.\ndomesticus", font=3)
segments( ((length(MLH1_by_F_strain$N)*expansion)*.34)-nudge, 20.5,
x1 = ((length(MLH1_by_F_strain$N)*expansion)*.4)-nudge+2,  y1 = 20.5, lwd=3)#mus
text(2,20, "M.m \nmusculus", font=3)
segments(((length(MLH1_by_F_strain$N)*expansion)*.6)-nudge, 20.5,
x1 = ((length(MLH1_by_F_strain$N)*expansion)*.6)-nudge+2, y1 = 20.5, lwd=3)#mol
text(8,20, "M.m. \nmolossinus", font=3)
dev.copy(png,'2FStrain_CO_means.png')
dev.off()
dev.copy(win.metafile, "2FStrain_CO_means.wmf")
dev.off()
MLH1_data$strain <- factor(MLH1_data$strain,
levels =c(  "G", "LEWES","WSB","PERA",
"PWD", "CZECHI",
"MSM",  "CAST","CIM",
"PANCEVO","CAROLI","RAT","Peromyscus","Microtus"), order=T )
MLH1_data$subsp <- factor(MLH1_data$subsp,
levels =c( "Dom", "Musc", "Musc-Cast",
"Cast", "Spic", "Caroli", "Outgroup", "other"), order=T )
MLH1_data <- with(MLH1_data, MLH1_data[order(subsp, strain),])
MLH1_by_F_strain <- MLH1_data[MLH1_data$sex == "female", ]
MLH1_by_M_strain <- MLH1_data[MLH1_data$sex == "male", ]
BD_data =  subset(MLH1_by_M_strain,  strain == "PERA" | strain == "CZECHI" | strain =="CIM" |  strain == "Peromyscus" |
strain == "PANCEVO" |  strain == "CAROLI" |  strain == "Microtus" | strain == "RAT" )
AP_data = subset(MLH1_by_M_strain, dataset == "AP")
MLH1_by_M_strain <- rbind(AP_data, BD_data)
MLH1_by_M_strain <- with(MLH1_by_M_strain, MLH1_by_M_strain[order(subsp, strain),])
expansion=2
par(mfrow=c(1,1))
par(cex = 1)
plot(x = c(-5, 50), y = c(20,40),
main ="", xlab ="", ylab = "Female MLH1 Foci", axes = F, type = "n", font.axis = 4)
strain_x_axis_scaffold = c(-1, (length(MLH1_by_F_strain$N)*expansion) )
axis(side = 2, at = c(0,20,22,24,26,28,30,32,34,36), labels = c("",20,22,24,26,28,30,32,34, ""), lwd = 3, font.axis = 3)
nudge = 8
f_strain_xspacing <- seq(2,28, by=4)
plotCI(x = f_strain_xspacing,   #x values are the spacing
y = as.numeric(MLH1_by_F_strain$mean_co), #y values, female means
uiw = (as.numeric(MLH1_by_F_strain$se)*2),
col = c("#56B4E9","cadetblue4","cadetblue",
"coral1","red",  "#E69F00", "yellowgreen"),
pch = 16,  #shape
lwd = 2, gap = 0, sfrac = 0.01, add = TRUE, cex=1.5)#cex controls point size
segments(((length(MLH1_by_F_strain$N)*expansion)*.23)-nudge, 20.5,
x1 =((length(MLH1_by_F_strain$N)*expansion)*.28)-nudge, y1 = 20.5, lwd=3)#dom
text(-3,20, "M.m.\ndomesticus", font=3)
segments( ((length(MLH1_by_F_strain$N)*expansion)*.34)-nudge, 20.5,
x1 = ((length(MLH1_by_F_strain$N)*expansion)*.4)-nudge+2,  y1 = 20.5, lwd=3)#mus
text(2,20, "M.m \nmusculus", font=3)
segments(((length(MLH1_by_F_strain$N)*expansion)*.6)-nudge, 20.5,
x1 = ((length(MLH1_by_F_strain$N)*expansion)*.6)-nudge+2, y1 = 20.5, lwd=3)#mol
text(8,20, "M.m. \nmolossinus", font=3)
library(plyr)
library(gplots)
library(ggplot2)
setwd("C:/Users/alpeterson7/Documents/MLH1data/Results/figures/")
load(file="MLH1_data_setup.RData")
MLH1_by_strain <- ddply(MLH1_data, c("category"), summarise,
N  = length(nMLH1.foci),
Nmice = length(unique(mouse)),
mean_co = mean(nMLH1.foci),
var = var(nMLH1.foci),
sd   = sd(nMLH1.foci),
se   = sd / sqrt(N)
#shape = () #I was getting errors with adding col and shape columns here
)
MLH1_by_strain
color <- ifelse(grepl("CAST", MLH1_by_strain$category), "green2",
#blue hues
ifelse(grepl("WSB", MLH1_by_strain$category), "cadetblue1",
ifelse(grepl("G", MLH1_by_strain$category), "cadetblue4",
ifelse(grepl("LEWES", MLH1_by_strain$category), "darkturquoise",
#reds
ifelse(grepl("PWD", MLH1_by_strain$category), "coral1",
ifelse(grepl("TOM", MLH1_by_strain$category), "coral1",
ifelse(grepl("KAZ", MLH1_by_strain$category), "firebrick1",
ifelse(grepl("MSM", MLH1_by_strain$category), "coral4", "black"))))))))
shape <- ifelse(grepl("female", MLH1_by_strain$category), 16,
ifelse(grepl("male", MLH1_by_strain$category), 17, 1 ))
MLH1_by_strain <- cbind(MLH1_by_strain, color, shape)
File <- "./CO_means.png"
dir.create(dirname(File), showWarnings = FALSE)
png(File)
x_axis_scaffold = seq(-1, (length(MLH1_by_strain$N)*2), by = 2)
par(mfrow=c(1,1))
par(cex = 1)
plot(x = c(-5, length(MLH1_by_strain)*2)+3, y = c(20,32),
main = "CO number by Mouse strains", xlab ="", ylab = "Mean MLH1 Foci Count", axes = F, type = "n", font.axis = 4)
axis(side = 1, at = x_axis_scaffold, labels =  rep(" ",length(x_axis_scaffold) ), lwd = 2, font.axis = 3)
axis(side = 2, at = c(0,20,22,24,26,28,30,31), labels = c("",20,22,24,26,28,30,""), lwd = 2)
segments(.3,20,1.3,20, lwd=2, col="black")#cast line
segments(3, 20, 11.5, 20, lwd=2, col="black")#mmDom line
segments(13, 20, 15, 20, lwd=2, col="black")#mmMus line
segments(18, 20, 22, 20, lwd=2, col="black")#mmMol line
xspacing = seq(.5, (length(MLH1_by_strain$N)*2)-3, length=length(MLH1_by_strain$N) )
colr_seq = (MLH1_by_strain$color)
colr_seq = c( "green3",
"cadetblue1","cadetblue1",
"cadetblue4",   "cadetblue4",
"darkturquoise",  "darkturquoise",
"coral1",   "coral1",
"firebrick1", "firebrick1")
plotCI(x = xspacing,   #x values are the spacing
y = MLH1_by_strain$mean_co, #y values, female means
uiw = MLH1_by_strain$se,
col = colr_seq,
#as.character(MLH1_by_strain$color), #not sure why color doesn't match the table contents
pch = MLH1_by_strain$shape,  #shape
lwd = 2, gap = 0, sfrac = 0.01, add = TRUE, cex=2.25)#cex controls point size
File <- "./MLH1_plot.png"
dir.create(dirname(File), showWarnings = FALSE)
png(File)
dev.off()
View(AP_strain_table)
View(MLH1_data_table)
all <- ggplot(data=MLH1_data, aes(mouse)) +
geom_boxplot(stat ="count") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
all
mouse_boxplots <- ggplot(data=MLH1_data, aes(mouse))
mouse_boxplots +  geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
View(MLH1_data)
mouse_boxplots <- ggplot(data=MLH1_data, aes(x =mouse, y=nMLH1.foci))
mouse_boxplots +  geom_boxplot(y=nMLH1.foci) + theme(axis.text.x = element_text(angle = 90, hjust = 1))
mouse_boxplots <- ggplot(data=MLH1_data, aes(x =mouse, y=nMLH1.foci))
mouse_boxplots +  geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))
mouse_boxplots
mouse_boxplots <- ggplot(data=MLH1_data, aes(x =mouse, y=nMLH1.foci))
mouse_boxplots
mouse_boxplots <- ggplot(data=MLH1_data, aes(x =mouse, y=nMLH1.foci))
mouse_boxplots +  geom_boxplot()
setwd("C:/Users/alpeterson7/Documents/MLH1data/src/")
load(file="MLH1_data_setup.RData")  #
df$category <- factor(df$category,
levels =c( "CAST male",
"G female", "G male",
"WSB female", "WSB male", "LEWES female", 'LEWES male',
"PWD female", "PWD male", "MSM female", "MSM male"),
order=TRUE )
new_df <- MLH1_data[with(MLH1_data, order(category)), ]
"PWD female", "PWD male", "MSM female", "MSM male"), order=T )
mus <- ggplot(df, aes(y=nMLH1.foci, x=mouse, fill = category)) + geom_boxplot()
mus
mus <- ggplot(df, aes(y=nMLH1.foci, x=mouse, fill = category)) + geom_boxplot()
mus + theme(axis.text.x = element_text(angle = 90, hjust = 1))
mus <- ggplot(new_df, aes(y=nMLH1.foci, x=mouse, fill = category)) + geom_boxplot()
mus
new_df <- MLH1_data[with(MLH1_data, order(category)), ]
"PWD female", "PWD male", "MSM female", "MSM male"), order=T )
df$category <- factor(df$category,
levels =c( "CAST male",
"G female", "G male",
"WSB female", "WSB male", "LEWES female", 'LEWES male',
"PWD female", "PWD male", "MSM female", "MSM male"),
order=TRUE )
new_df <- MLH1_data[with(MLH1_data, order(category)), ]
"PWD female", "PWD male", "MSM female", "MSM male"), order=T )
new_df <- MLH1_data[with(MLH1_data, order(category)), ]
mus <- ggplot(MLH1_data, aes(y=nMLH1.foci, x=mouse, fill = category)) + geom_boxplot()
mus
df
MLH1_data$category <- factor(MLH1_data$category,
levels =c( "CAST male",
"G female", "G male",
"WSB female", "WSB male", "LEWES female", 'LEWES male',
"PWD female", "PWD male", "MSM female", "MSM male"),
order=TRUE )
View(MLH1_data)
mus <- ggplot(MLH1_data, aes(y=nMLH1.foci, x=mouse, fill = strain)) + geom_boxplot()
mus
mus <- ggplot(MLH1_data, aes(y=nMLH1.foci, x=strain, fill = strain)) + geom_boxplot()
mus
mus <- ggplot(MLH1_data, aes(y=mean_co, x=strain, fill = strain)) + geom_boxplot()
mus
mus
setwd("C:/Users/alpeterson7/Documents/MLH1data/Results/figures/")
load(file="MLH1_data_setup.RData")
MLH1_data$strain <- factor(MLH1_data$strain,
levels =c(  "G", "LEWES","WSB","PERA",
"PWD", "CZECHI",
"MSM",  "CAST","CIM",
"PANCEVO","CAROLI","RAT","Peromyscus","Microtus"), order=T )
MLH1_data$subsp <- factor(MLH1_data$subsp,
levels =c( "Dom", "Musc", "Musc-Cast",
"Cast", "Spic", "Caroli", "Outgroup", "other"), order=T )
MLH1_data$subsp <- factor(MLH1_data$subsp,levels =c( "Dom", "Musc", "Musc-Cast",
"Cast", "Spic", "Caroli", "Outgroup", "other"), order=T )
View(MLH1_data)
MLH1_by_F_strain <- MLH1_data[MLH1_data$sex == "female", ]
MLH1_by_M_strain <- MLH1_data[MLH1_data$sex == "male", ]
expansion=2
par(mfrow=c(1,1))
par(cex = 1)
plot(x = c(-5, 50), y = c(20,40),
main ="", xlab ="", ylab = "Female MLH1 Foci", axes = F, type = "n", font.axis = 4)
strain_x_axis_scaffold = c(-1, (length(MLH1_by_F_strain$N)*expansion) )
axis(side = 2, at = c(0,20,22,24,26,28,30,32,34,36), labels = c("",20,22,24,26,28,30,32,34, ""), lwd = 3, font.axis = 3)
nudge = 8
f_strain_xspacing <- seq(2,28, by=4)
plotCI(x = f_strain_xspacing,   #x values are the spacing
y = as.numeric(MLH1_by_F_strain$mean_co), #y values, female means
uiw = (as.numeric(MLH1_by_F_strain$se)*2),
col = c("#56B4E9","cadetblue4","cadetblue",
"coral1","red",  "#E69F00", "yellowgreen"),
pch = 16,  #shape
lwd = 2, gap = 0, sfrac = 0.01, add = TRUE, cex=1.5)#cex controls point size
segments(((length(MLH1_by_F_strain$N)*expansion)*.23)-nudge, 20.5,
x1 =((length(MLH1_by_F_strain$N)*expansion)*.28)-nudge, y1 = 20.5, lwd=3)#dom
text(-3,20, "M.m.\ndomesticus", font=3)
segments( ((length(MLH1_by_F_strain$N)*expansion)*.34)-nudge, 20.5,
x1 = ((length(MLH1_by_F_strain$N)*expansion)*.4)-nudge+2,  y1 = 20.5, lwd=3)#mus
text(2,20, "M.m \nmusculus", font=3)
segments(((length(MLH1_by_F_strain$N)*expansion)*.6)-nudge, 20.5,
x1 = ((length(MLH1_by_F_strain$N)*expansion)*.6)-nudge+2, y1 = 20.5, lwd=3)#mol
text(8,20, "M.m. \nmolossinus", font=3)
dev.copy(png,'2FStrain_CO_means.png')
dev.off()
View(MLH1_data)
plot(MLH1_data$nMLH1.foci ~ MLH1_data$quality)
plot(MLH1_data$nMLH1.foci ~ MLH1_data$quality)
see <- plot(MLH1_data$nMLH1.foci ~ MLH1_data$quality)
see
see <- plot(MLH1_data$nMLH1.foci, MLH1_data$quality)
see
dev.off()
see <- plot(MLH1_data$nMLH1.foci, MLH1_data$quality)
c <- ggplot(MLH1_data, aes(x=mouse, y=nMLH1.foci))
c + geom_boxplot()
bx <- ggplot(MLH1_data, aes(factor(category), nMLH1.foci))
bx + geom_boxplot()
geom_boxplot(data = MLH1_data, aes(fill = factor(strain)))
bx
bx <- ggplot(MLH1_data, aes(factor(mouse), nMLH1.foci))
bx + geom_boxplot()
bx <- ggplot(MLH1_data, aes(factor(mouse), nMLH1.foci))
bx + geom_boxplot(data = MLH1_data, aes(fill = factor(strain)))
boxplots <- ggplot(MLH1_data, aes(factor(mouse), nMLH1.foci)) + geom_boxplot(data = MLH1_data, aes(fill = factor(strain)))
filename_boxplots <- paste("../figures/boxplots.png")
ggsave(filename_boxplots, plot = boxplots, width = 3, height = 2.5)
setwd("C:/Users/alpeterson7/Documents/MLH1repo/")
boxplots <- ggplot(MLH1_data, aes(factor(mouse), nMLH1.foci)) + geom_boxplot(data = MLH1_data, aes(fill = factor(strain)))
filename_boxplots <- paste("../figures/boxplots.png")
ggsave(filename_boxplots, plot = boxplots, width = 3, height = 2.5)
boxplots <- ggplot(MLH1_data, aes(factor(mouse), nMLH1.foci)) + geom_boxplot(data = MLH1_data, aes(fill = factor(strain)))
setwd("C:/Users/alpeterson7/Documents/MLH1repo")
filename_boxplots <- paste("../figures/boxplots.png")
ggsave(filename_boxplots, plot = boxplots, width = 3, height = 2.5)
dev.off()
boxplots <-
ggplot(MLH1_data, aes(factor(mouse), nMLH1.foci)) + geom_boxplot(data = MLH1_data, aes(fill = factor(strain)))
ggsave(filename_boxplots, plot = boxplots, width = 3, height = 2.5)
ggsave("filename_boxplots.png")
